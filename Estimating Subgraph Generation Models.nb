(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    158723,       3711]
NotebookOptionsPosition[    150835,       3596]
NotebookOutlinePosition[    151179,       3611]
CellTagsIndexPosition[    151136,       3608]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Estimating Subgraph Generation Models", "Title",
 CellChangeTimes->{{3.7311485430970516`*^9, 3.7311485535042944`*^9}, {
  3.7347687641896825`*^9, 
  3.7347687695334415`*^9}},ExpressionUUID->"8f6ba89d-3c28-4ee5-949d-\
393fa35e6fce"],

Cell["\<\
Laurens Bogaardt | Netherlands eScience Center | l.bogaardt@esciencecenter.nl\
\[LineSeparator]Frank W. Takes | University of Amsterdam | takes@uva.nl\
\>", "Subsubtitle",
 CellChangeTimes->{{3.7362513054613028`*^9, 3.7362514105561385`*^9}, 
   3.7364396586222906`*^9},ExpressionUUID->"c185089a-75bc-47b7-98eb-\
f4ae90efd4d9"],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 CellChangeTimes->{{3.7313945520470543`*^9, 3.7313945691579266`*^9}, {
  3.7362514851711984`*^9, 
  3.7362514878591967`*^9}},ExpressionUUID->"7128cf08-7110-4f96-975b-\
dad6a102c09f"],

Cell[TextData[{
 "Social scientists often aim to understand the incentives and mechanisms \
which result in large scale structures. Key to this is network formation \
analysis. However, large datasets are not uncommon, leading to a \
computational challenge. For example, political scientists interested in \
global networks of corporate control may analyse millions of companies.\n\n\
The Exponential Random Graph Model (ERGM) is a frequently used network \
formation model. Unfortunately, it suffers from two fundamental flaws. \
Firstly, its parameter estimates are inconsistent [1, 2]. Secondly, it does \
not scale well [3]. Recently, an alternative network formation model was \
suggested: the Subgraph Generation Model (SUGM) [4, 5, 6].\n\nThis ",
 StyleBox["Mathematica Notebook",
  FontSlant->"Italic"],
 " examines SUGMs and a method of estimating their parameters using the \
subgraph census.\n\nAt the end of this ",
 StyleBox["Mathematica Notebook",
  FontSlant->"Italic"],
 ", a Manipulate will be created which contains simulations. Some simulations \
take a long time to evaluate. To accommodate this, the timeout threshold \
needs to be increased."
}], "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 3.7313961250085583`*^9}, {
  3.7362412191826963`*^9, 3.7362413233434696`*^9}, {3.7362514780719137`*^9, 
  3.73625148003666*^9}},ExpressionUUID->"2b412d49-4302-46f2-a481-\
f763a12c88af"],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{"$FrontEnd", ",", 
   RowBox[{"DynamicEvaluationTimeout", "\[Rule]", "900"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7313160788226504`*^9, 3.731316081182308*^9}, {
   3.7313161603783703`*^9, 3.731316160925169*^9}, {3.7327962804672704`*^9, 
   3.732796281373739*^9}, {3.7350306461977296`*^9, 3.735030669943859*^9}, 
   3.7353808645827265`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"f5be415c-7994-41ae-99ef-bad344b357cd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Subgraph Generation", "Section",
 CellChangeTimes->{{3.7311485456128216`*^9, 3.731148566553211*^9}, {
  3.73201077994914*^9, 3.732010780105526*^9}, {3.734768757642803*^9, 
  3.73476876054906*^9}},ExpressionUUID->"ffb55aa8-dbfc-4cdf-952b-\
e33f8d6c0061"],

Cell[TextData[{
 "A SUGM is defined by a set of ",
 StyleBox["l",
  FontSlant->"Italic"],
 " small subgraphs, such as links, triangles or stars, each with \
corresponding probabilities. For each subgraph ",
 StyleBox["i",
  FontSlant->"Italic"],
 " of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "i"], TraditionalForm]],ExpressionUUID->
  "2930e5ff-14a0-4338-993f-ac24f911dedd"],
 " nodes, the ",
 StyleBox["n",
  FontSlant->"Italic"],
 " nodes of the entire network are grouped into all possible subsets of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "i"], TraditionalForm]],ExpressionUUID->
  "8f18c02f-35ee-4e47-a4ec-834bfcb1f529"],
 " nodes. Then, each of these subsets receives the subgraph ",
 StyleBox["i",
  FontSlant->"Italic"],
 " with probability ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "i"], TraditionalForm]],ExpressionUUID->
  "c127cdb6-9d2d-480b-99a5-760ea6f4f59e"],
 " or remains empty with probability ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "-", 
    SubscriptBox["p", "i"]}], TraditionalForm]],ExpressionUUID->
  "bfb8855d-1211-4903-936a-a2d357d16f3d"],
 "."
}], "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 3.7313961250085583`*^9}, {
  3.736237915037678*^9, 3.7362379160545616`*^9}, {3.7362413320351996`*^9, 
  3.7362414770695925`*^9}, {3.7362509752637787`*^9, 
  3.736250978152176*^9}},ExpressionUUID->"41a58947-fa06-4943-acc6-\
fc06a6fe9048"],

Cell[CellGroupData[{

Cell["Subgraph Types", "Subsection",
 CellChangeTimes->{{3.7313136105953646`*^9, 3.7313136348285203`*^9}, 
   3.7313961390776787`*^9, {3.734768800377195*^9, 
   3.734768836236582*^9}},ExpressionUUID->"0aa8c034-c27e-40fd-865c-\
dfb3ba6bc78c"],

Cell["Text", "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 
  3.7313961250085583`*^9}},ExpressionUUID->"855f78c9-86ee-4a90-bafd-\
df92fbaf9656"],

Cell[BoxData[
 RowBox[{
  RowBox[{"subgraphSizes", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "4"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7353668188503513`*^9, 3.7353668271847153`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"6eeed15d-e16a-4848-a2cb-6e06a1616b73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"subgraphNodes", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<Links\>\"", "\[Rule]", "2"}], ",", 
     RowBox[{"\"\<Paths\>\"", "\[Rule]", "3"}], ",", 
     RowBox[{"\"\<Triangles\>\"", "\[Rule]", "3"}], ",", 
     RowBox[{"\"\<Stars\>\"", "\[Rule]", "4"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.732903662654423*^9, 3.7329036798123603`*^9}, {
   3.7330531988180304`*^9, 3.733053200193162*^9}, {3.73329885692509*^9, 
   3.7332989424817333`*^9}, {3.7332993162123938`*^9, 3.7332993427646017`*^9}, 
   3.73330657598905*^9, {3.7333321624434586`*^9, 3.7333321631238146`*^9}, 
   3.733332260566299*^9, {3.7334698773942275`*^9, 3.733469878687482*^9}, {
   3.733725600230807*^9, 3.7337256039417777`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"8a6c9d73-8bb4-4607-9842-1db1d6d1ef05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"subgraphEdgeMap", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"\"\<Links\>\"", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[UndirectedEdge]", 
          RowBox[{"x", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"\"\<Paths\>\"", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[UndirectedEdge]", 
           RowBox[{"x", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[UndirectedEdge]", 
           RowBox[{"x", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"\"\<Triangles\>\"", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[UndirectedEdge]", 
           RowBox[{"x", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[UndirectedEdge]", 
           RowBox[{"x", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "\[UndirectedEdge]", 
           RowBox[{"x", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"\"\<Stars\>\"", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "x", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[UndirectedEdge]", 
           RowBox[{"x", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[UndirectedEdge]", 
           RowBox[{"x", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[UndirectedEdge]", 
           RowBox[{"x", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7365704706738644`*^9, 3.7365705515191956`*^9}, {
  3.7365707887928534`*^9, 3.7365707911678715`*^9}, {3.7365710233958397`*^9, 
  3.736571026567395*^9}, {3.7365714271310377`*^9, 3.736571484005557*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"9a53b5c3-3713-4cc3-b7b2-d51aefde4cae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"subgraphCases", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"2", "->", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<Links\>\"", "\[Rule]", 
         RowBox[{"Function", "[", 
          RowBox[{"n", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], ",", 
        RowBox[{"\"\<Paths\>\"", "\[Rule]", 
         RowBox[{"Function", "[", 
          RowBox[{"n", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", "/", "3"}], 
             RowBox[{"Binomial", "[", 
              RowBox[{
               RowBox[{"n", "-", "2"}], ",", "1"}], "]"}]}], "}"}]}], "]"}]}],
         ",", 
        RowBox[{"\"\<Triangles\>\"", "->", 
         RowBox[{"Function", "[", 
          RowBox[{"n", ",", 
           RowBox[{"{", 
            RowBox[{"Binomial", "[", 
             RowBox[{
              RowBox[{"n", "-", "2"}], ",", "1"}], "]"}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<Stars\>\"", "->", 
         RowBox[{"Function", "[", 
          RowBox[{"n", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2", "/", "4"}], 
             RowBox[{"Binomial", "[", 
              RowBox[{
               RowBox[{"n", "-", "2"}], ",", "2"}], "]"}]}], "}"}]}], 
          "]"}]}]}], "]"}]}], ",", 
     RowBox[{"3", "->", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<Links\>\"", "\[Rule]", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "n", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"\"\<Paths\>\"", "\[Rule]", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "n", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"2", "/", "3"}], 
              RowBox[{"Binomial", "[", 
               RowBox[{
                RowBox[{"n", "-", "3"}], ",", "1"}], "]"}]}], ",", 
             RowBox[{"1", "/", "3"}], ",", "0"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"\"\<Triangles\>\"", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "n", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Binomial", "[", 
              RowBox[{
               RowBox[{"n", "-", "3"}], ",", "1"}], "]"}], ",", "0", ",", 
             "1"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"\"\<Stars\>\"", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "n", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"2", "/", "4"}], 
              RowBox[{"Binomial", "[", 
               RowBox[{
                RowBox[{"n", "-", "3"}], ",", "2"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"1", "/", "4"}], 
              RowBox[{"Binomial", "[", 
               RowBox[{
                RowBox[{"n", "-", "3"}], ",", "1"}], "]"}]}], ",", "0"}], 
            "}"}]}], "]"}]}]}], "]"}]}], ",", 
     RowBox[{"4", "->", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<Links\>\"", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "n", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<Paths\>\"", "\[Rule]", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "n", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"2", "/", "3"}], 
              RowBox[{"Binomial", "[", 
               RowBox[{
                RowBox[{"n", "-", "4"}], ",", "1"}], "]"}]}], ",", 
             RowBox[{"1", "/", "3"}], ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<Triangles\>\"", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "n", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Binomial", "[", 
              RowBox[{
               RowBox[{"n", "-", "4"}], ",", "1"}], "]"}], ",", "0", ",", "1",
              ",", "0"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"\"\<Stars\>\"", "->", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "n", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"2", "/", "4"}], 
              RowBox[{"Binomial", "[", 
               RowBox[{
                RowBox[{"n", "-", "4"}], ",", "2"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"1", "/", "4"}], 
              RowBox[{"Binomial", "[", 
               RowBox[{
                RowBox[{"n", "-", "4"}], ",", "1"}], "]"}]}], ",", "0", ",", 
             RowBox[{"1", "/", "4"}]}], "}"}]}], "]"}]}]}], "]"}]}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7352743167095203`*^9, 3.735274340225129*^9}, {
  3.735275211465928*^9, 3.7352752491379547`*^9}, {3.7352794052465396`*^9, 
  3.7352794084966955`*^9}, {3.735280609052021*^9, 3.7352806100520277`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"61f09b4b-a51a-443d-b490-eb656f7432ea"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generating Functions", "Subsection",
 CellChangeTimes->{{3.7313136105953646`*^9, 3.7313136348285203`*^9}, {
  3.7313961390776787`*^9, 3.7313961605924416`*^9}, {3.736251124683565*^9, 
  3.736251127789432*^9}},ExpressionUUID->"d1677566-2ef4-4d9a-bda6-\
34cb1b4aea21"],

Cell["\<\
This subsection defines 4 types of subgraph generating functions, namely \
links, 2-paths, triangles and 3-stars.\
\>", "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 3.7313961250085583`*^9}, {
  3.7362509931555195`*^9, 
  3.736251035907876*^9}},ExpressionUUID->"6b13224d-76cf-4ba2-917f-\
cf50a5fbf396"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateNodeSubsets", "[", 
   RowBox[{"n_", ",", "p_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sampleSize", "=", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{"BinomialDistribution", "[", 
        RowBox[{
         RowBox[{"Binomial", "[", 
          RowBox[{"n", ",", "k"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Binomial", "[", 
            RowBox[{"n", ",", "2"}], "]"}], "/", 
           RowBox[{"Binomial", "[", 
            RowBox[{"n", ",", "k"}], "]"}]}], "p"}]}], "]"}], "]"}]}], "}"}], 
    ",", 
    RowBox[{"RandomSample", "[", 
     RowBox[{
      RowBox[{"Subsets", "[", 
       RowBox[{
        RowBox[{"Range", "[", "n", "]"}], ",", 
        RowBox[{"{", "k", "}"}]}], "]"}], ",", "sampleSize"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.732952091378067*^9, 3.7329521136895084`*^9}, {
   3.7329523258915253`*^9, 3.732952330954563*^9}, {3.7329524021261015`*^9, 
   3.732952406942213*^9}, {3.732952444010045*^9, 3.7329524458696012`*^9}, {
   3.732952860547691*^9, 3.7329528699705534`*^9}, {3.7329529680399218`*^9, 
   3.732952975168813*^9}, 3.7329530143342495`*^9, {3.7329531530756474`*^9, 
   3.732953157794056*^9}, {3.733288290775251*^9, 3.7332883436102753`*^9}, {
   3.733288402232568*^9, 3.7332884034648857`*^9}, {3.736494747233901*^9, 
   3.7364947685793405`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"e12821af-4f69-4eda-b19e-f6fb6ccb1489"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateGraph", "[", 
   RowBox[{"n_", ",", "p_", ",", "k_", ",", "m_"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"Sort", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"m", ",", 
      RowBox[{"Map", "[", 
       RowBox[{"RandomSample", ",", 
        RowBox[{"generateNodeSubsets", "[", 
         RowBox[{"n", ",", "p", ",", "k"}], "]"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7365703849118223`*^9, 3.7365704630840254`*^9}, 
   3.7365705118293777`*^9, {3.7365706060536294`*^9, 3.736570609506754*^9}, {
   3.7365706584801645`*^9, 3.736570660356343*^9}, {3.7365707493118286`*^9, 
   3.7365708764370527`*^9}, {3.736570909299258*^9, 3.736571017692738*^9}, {
   3.7365710888805375`*^9, 3.736571099203555*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"c2316eec-5e18-4751-8f83-d2b8ee8ac5c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateGraphList", "[", 
   RowBox[{"n_", ",", "pMap_"}], "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"KeyValueMap", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"generateGraph", "[", 
        RowBox[{"n", ",", "#2", ",", 
         RowBox[{"subgraphNodes", "[", "#1", "]"}], ",", 
         RowBox[{"subgraphEdgeMap", "[", "#1", "]"}]}], "]"}], "&"}], ",", 
      "pMap"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.736571332122161*^9, 3.7365713630494347`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"1e8b3f1e-91d5-4712-99d1-82e4156f30a6"],

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"figureList", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Null", ",", "8"}], "]"}]}], "}"}], ",", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<\>\"", ",", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Export Figure 1\>\"", ",", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"Export", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "<>", 
                "\"\<\\\\Figure01_\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.pdf\>\""}], 
               ",", 
               RowBox[{"figureList", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "figureList", "]"}]}], "}"}]}], "]"}]}],
           "]"}], ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\>\"", ",", "\"\<Graph\>\"", ",", 
         "\"\<Degree distribution\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Links\>\"", ",", 
         RowBox[{
          RowBox[{"figureList", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "=", 
          RowBox[{"Graph", "[", 
           RowBox[{"generateGraphList", "[", 
            RowBox[{"20", ",", 
             RowBox[{"Association", "[", 
              RowBox[{"\"\<Links\>\"", "\[Rule]", "0.1"}], "]"}]}], "]"}], 
           "]"}]}], ",", 
         RowBox[{
          RowBox[{"figureList", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "=", 
          RowBox[{"Histogram", "[", 
           RowBox[{"VertexDegree", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"generateGraphList", "[", 
              RowBox[{"400", ",", 
               RowBox[{"Association", "[", 
                RowBox[{"\"\<Links\>\"", "\[Rule]", "0.1"}], "]"}]}], "]"}], 
             "]"}], "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Paths\>\"", ",", 
         RowBox[{
          RowBox[{"figureList", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "=", 
          RowBox[{"Graph", "[", 
           RowBox[{"generateGraphList", "[", 
            RowBox[{"20", ",", 
             RowBox[{"Association", "[", 
              RowBox[{"\"\<Paths\>\"", "\[Rule]", "0.05"}], "]"}]}], "]"}], 
           "]"}]}], ",", 
         RowBox[{
          RowBox[{"figureList", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "=", 
          RowBox[{"Histogram", "[", 
           RowBox[{"VertexDegree", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"generateGraphList", "[", 
              RowBox[{"240", ",", 
               RowBox[{"Association", "[", 
                RowBox[{"\"\<Paths\>\"", "\[Rule]", "0.05"}], "]"}]}], "]"}], 
             "]"}], "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Triangles\>\"", ",", 
         RowBox[{
          RowBox[{"figureList", "[", 
           RowBox[{"[", "5", "]"}], "]"}], "=", 
          RowBox[{"Graph", "[", 
           RowBox[{"generateGraphList", "[", 
            RowBox[{"15", ",", 
             RowBox[{"Association", "[", 
              RowBox[{"\"\<Triangles\>\"", "\[Rule]", "0.1"}], "]"}]}], "]"}],
            "]"}]}], ",", 
         RowBox[{
          RowBox[{"figureList", "[", 
           RowBox[{"[", "6", "]"}], "]"}], "=", 
          RowBox[{"Histogram", "[", 
           RowBox[{"VertexDegree", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"generateGraphList", "[", 
              RowBox[{"240", ",", 
               RowBox[{"Association", "[", 
                RowBox[{"\"\<Triangles\>\"", "\[Rule]", "0.1"}], "]"}]}], 
              "]"}], "]"}], "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Stars\>\"", ",", 
         RowBox[{
          RowBox[{"figureList", "[", 
           RowBox[{"[", "7", "]"}], "]"}], "=", 
          RowBox[{"Graph", "[", 
           RowBox[{"generateGraphList", "[", 
            RowBox[{"15", ",", 
             RowBox[{"Association", "[", 
              RowBox[{"\"\<Stars\>\"", "\[Rule]", "0.1"}], "]"}]}], "]"}], 
           "]"}]}], ",", 
         RowBox[{
          RowBox[{"figureList", "[", 
           RowBox[{"[", "8", "]"}], "]"}], "=", 
          RowBox[{"Histogram", "[", 
           RowBox[{"VertexDegree", "[", 
            RowBox[{"Graph", "[", 
             RowBox[{"generateGraphList", "[", 
              RowBox[{"170", ",", 
               RowBox[{"Association", "[", 
                RowBox[{"\"\<Stars\>\"", "\[Rule]", "0.1"}], "]"}]}], "]"}], 
             "]"}], "]"}], "]"}]}]}], "}"}]}], "}"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.732008214923176*^9, 3.7320082178764887`*^9}, {
   3.732008288837142*^9, 3.732008418038354*^9}, {3.7320084867018967`*^9, 
   3.7320085689450984`*^9}, {3.7320086270317154`*^9, 
   3.7320087378665915`*^9}, {3.732008781699237*^9, 3.732008814296559*^9}, {
   3.732008906024931*^9, 3.732009079449583*^9}, {3.732957566756337*^9, 
   3.732957586128934*^9}, {3.7329576323994756`*^9, 3.732957636743568*^9}, 
   3.73296156650099*^9, {3.733048881677599*^9, 3.733048924510361*^9}, {
   3.7332884248120356`*^9, 3.733288461886881*^9}, {3.7332885260494385`*^9, 
   3.7332885263630767`*^9}, {3.7333023347657413`*^9, 
   3.7333023422821455`*^9}, {3.733302640498207*^9, 3.7333026569508095`*^9}, {
   3.7333027419009666`*^9, 3.733302752617755*^9}, {3.734762416656705*^9, 
   3.734762448813108*^9}, {3.7347625509067473`*^9, 3.734762556531889*^9}, {
   3.7347658062512665`*^9, 3.7347658078762655`*^9}, {3.735450833247465*^9, 
   3.735450902114541*^9}, {3.7355749733558245`*^9, 3.7355749892101507`*^9}, {
   3.7355751163160305`*^9, 3.735575146372158*^9}, {3.7357355747531505`*^9, 
   3.735735635874653*^9}, {3.7357356711854477`*^9, 3.735735762197099*^9}, 
   3.735735816157022*^9, {3.7364894504058466`*^9, 3.7364894536402235`*^9}, {
   3.7364894916776733`*^9, 3.73648963276433*^9}, {3.736489736583359*^9, 
   3.736489765227152*^9}, {3.736492078089924*^9, 3.736492328692966*^9}, {
   3.7364924334838552`*^9, 3.736492436671342*^9}, {3.736492522955838*^9, 
   3.7364925762543335`*^9}, {3.736492685414982*^9, 3.7364927855200357`*^9}, {
   3.736492878965066*^9, 3.7364928812149425`*^9}, 3.736492952971283*^9, {
   3.7364930168736115`*^9, 3.736493052438768*^9}, {3.7364930849263277`*^9, 
   3.7364931424751606`*^9}, {3.736493181940159*^9, 3.736493189052873*^9}, {
   3.736493258099211*^9, 3.736493297756873*^9}, {3.736493334457215*^9, 
   3.736493339759619*^9}, {3.7364934171561546`*^9, 3.7364934531945057`*^9}, {
   3.7364935085079327`*^9, 3.736493527684685*^9}, 3.7364936403047395`*^9, {
   3.736493672655897*^9, 3.7364936770152655`*^9}, {3.736493887002597*^9, 
   3.7364938921432176`*^9}, {3.7364939546782246`*^9, 3.736493954849965*^9}, {
   3.7364942375358453`*^9, 3.736494245382993*^9}, 3.736494275884883*^9, {
   3.7364945111850395`*^9, 3.736494533598819*^9}, {3.7364946144175053`*^9, 
   3.736494626278283*^9}, {3.736495113916972*^9, 3.7364951326197968`*^9}, {
   3.7364952091004477`*^9, 3.7364952200916214`*^9}, {3.7365715265586805`*^9, 
   3.736571551347286*^9}, {3.736571588055687*^9, 3.736571653303575*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"6a126404-58a0-400a-871f-d8733be06ce3"],

Cell[TextData[{
 "The figures above show simulations for each of the generating functions for \
particular values of the probability ",
 StyleBox["p",
  FontSlant->"Italic"],
 ", together with an approximation of their degree distribution."
}], "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 3.7313961250085583`*^9}, {
  3.736251056628544*^9, 
  3.7362511169149027`*^9}},ExpressionUUID->"1bd9db9e-0160-4573-810f-\
4428c39e5f3f"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Overlapping Subgraphs", "Section",
 CellChangeTimes->{{3.7311485456128216`*^9, 3.731148566553211*^9}, {
  3.734768750502039*^9, 
  3.7347687538928003`*^9}},ExpressionUUID->"9cb124b7-49d8-4205-b351-\
1fe9fc0ded06"],

Cell["\<\
The observed network, left in the figure below, is the union of all these \
subgraphs, right in figure below, where the generated subgraphs may overlap. \
Multiple neighbouring subgraphs may incidentally form additional structures \
such as triangles or squares.\
\>", "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 3.7313961250085583`*^9}, 
   3.736237936242922*^9, {3.7362415736422396`*^9, 
   3.7362415839849873`*^9}},ExpressionUUID->"f3df441d-7594-489d-b678-\
4e4614b60342"],

Cell[CellGroupData[{

Cell["Observed and Underlying Data", "Subsection",
 CellChangeTimes->{{3.7313136105953646`*^9, 3.7313136348285203`*^9}, {
  3.7313961390776787`*^9, 3.7313961605924416`*^9}, {3.736251141782386*^9, 
  3.7362511501822987`*^9}},ExpressionUUID->"5570249b-c4a1-496b-a9f0-\
f70fd1f3d08e"],

Cell["Text", "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 
  3.7313961250085583`*^9}},ExpressionUUID->"94796fc5-7ef6-4608-ab1a-\
fd52dcabf67c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"drawColouredGraph", "[", 
   RowBox[{"colorList_", ",", "edgeLists_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"uniqueEdges", "=", 
      RowBox[{"DeleteDuplicates", "[", 
       RowBox[{"Flatten", "[", "edgeLists", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"edgeStyles", "=", 
        RowBox[{"AssociationMap", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "uniqueEdge", "}"}], ",", 
            RowBox[{"Pick", "[", 
             RowBox[{"colorList", ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{"#", ",", "uniqueEdge"}], "]"}], "&"}], ",", 
                "edgeLists"}], "]"}]}], "]"}]}], "]"}], ",", "uniqueEdges"}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"edgeIndex", "=", 
          RowBox[{"AssociationThread", "[", 
           RowBox[{"uniqueEdges", "\[Rule]", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", "uniqueEdges", "]"}]}], "]"}]}], "]"}]}],
          "}"}], ",", 
        RowBox[{"Fold", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SetProperty", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"#1", ",", "#2"}], "}"}], ",", 
              RowBox[{"EdgeShapeFunction", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"edgeStyles", "[", "#2", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"edgeIndex", "[", "#2", "]"}], "++"}], "]"}], 
                    "]"}], ",", 
                   RowBox[{"Line", "[", "#", "]"}]}], "}"}], "&"}], ")"}]}]}],
              "]"}], ")"}], "&"}], ",", 
          RowBox[{"Graph", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Map", "[", 
             RowBox[{"Union", ",", "edgeLists"}], "]"}], "]"}], "]"}], ",", 
          "uniqueEdges"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7355528475996695`*^9, 3.735552923430794*^9}, {
   3.735553004014781*^9, 3.735553009305085*^9}, {3.7355534287126646`*^9, 
   3.7355534398430414`*^9}, {3.7355543365040145`*^9, 
   3.7355543388010297`*^9}, {3.735554388353117*^9, 3.7355543953687897`*^9}, {
   3.7355545352297926`*^9, 3.735554556872334*^9}, {3.7355548717076817`*^9, 
   3.7355548718484545`*^9}, 3.7355549057782884`*^9, 3.735554942142222*^9, 
   3.735554978906968*^9, 3.735555028849889*^9, {3.735555066730283*^9, 
   3.735555156857773*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"09d73d03-3e58-4474-93f6-76001c0482b7"],

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"refreshDummy", "=", "0"}], ",", 
     RowBox[{"figureList", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"Null", ",", "2"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"refreshDummy", ";", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"colorList", "=", 
           RowBox[{"{", 
            RowBox[{"Red", ",", "Purple", ",", "Green", ",", "Orange"}], 
            "}"}]}], ",", 
          RowBox[{"edgeLists", "=", 
           RowBox[{"KeyValueMap", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"generateGraph", "[", 
                RowBox[{"n", ",", "#2", ",", 
                 RowBox[{"subgraphNodes", "[", "#1", "]"}], ",", 
                 RowBox[{"subgraphEdgeMap", "[", "#1", "]"}]}], "]"}], "]"}], 
              "&"}], ",", 
             RowBox[{"Association", "[", 
              RowBox[{
               RowBox[{"\"\<Links\>\"", "\[Rule]", "pL"}], ",", 
               RowBox[{"\"\<Paths\>\"", "\[Rule]", "pP"}], ",", 
               RowBox[{"\"\<Triangles\>\"", "\[Rule]", "pT"}], ",", 
               RowBox[{"\"\<Stars\>\"", "\[Rule]", "pS"}]}], "]"}]}], 
            "]"}]}]}], "}"}], ",", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"edgeList", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"Flatten", "[", "edgeLists", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"Grid", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<Observed graph\>\"", ",", "\"\<Underlying reality\>\""}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"figureList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "=", 
                RowBox[{"Show", "[", 
                 RowBox[{
                  RowBox[{"Graph", "[", "edgeList", "]"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "350"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"figureList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "=", 
                RowBox[{"Show", "[", 
                 RowBox[{
                  RowBox[{"drawColouredGraph", "[", 
                   RowBox[{"colorList", ",", "edgeLists"}], "]"}], ",", 
                  RowBox[{"ImageSize", "\[Rule]", "350"}]}], "]"}]}]}], 
              "}"}]}], "}"}], "]"}]}], "]"}]}], "]"}]}], ",", 
     RowBox[{"Grid", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Control", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"n", ",", "10"}], "}"}], ",", "5", ",", "30", ",", "1", 
             ",", 
             RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}], 
           "]"}], ",", "\"\<\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Control", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"pL", ",", "0.06"}], "}"}], ",", "0.0", ",", "0.1", ",",
              "0.01", ",", 
             RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}], 
           "]"}], ",", 
          RowBox[{"Control", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"pP", ",", "0.03"}], "}"}], ",", "0.0", ",", "0.1", ",",
              "0.01", ",", 
             RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Control", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"pT", ",", "0.02"}], "}"}], ",", "0.0", ",", "0.1", ",",
              "0.01", ",", 
             RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}], 
           "]"}], ",", 
          RowBox[{"Control", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"pS", ",", "0.01"}], "}"}], ",", "0.0", ",", "0.1", ",",
              "0.01", ",", 
             RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Refresh\>\"", ",", 
            RowBox[{"refreshDummy", "=", 
             RowBox[{"RandomReal", "[", "]"}]}]}], "]"}], ",", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Export Figure 2\>\"", ",", 
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ToString", "[", 
                   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "<>", 
                  "\"\<\\\\Figure02_\>\"", "<>", 
                  RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.pdf\>\""}],
                  ",", 
                 RowBox[{"figureList", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "figureList", "]"}]}], "}"}]}], 
             "]"}]}], "]"}], ",", "\"\<\>\""}], "}"}]}], "}"}], "]"}]}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7355530878854203`*^9, 3.7355532236369514`*^9}, {
   3.735553346584317*^9, 3.735553368837308*^9}, {3.7355534560529094`*^9, 
   3.735553499780528*^9}, {3.7355535683580914`*^9, 3.7355536142831945`*^9}, {
   3.735553649980457*^9, 3.735553661011067*^9}, {3.735554194887784*^9, 
   3.735554233574047*^9}, {3.7355545682230563`*^9, 3.735554621712383*^9}, {
   3.7355547001069536`*^9, 3.7355547076694536`*^9}, {3.735554865749965*^9, 
   3.7355548679532347`*^9}, 3.7355549037312737`*^9, 3.7355549412203755`*^9, 
   3.7355549794538403`*^9, 3.73555502820926*^9, {3.73555506602703*^9, 
   3.735555154685751*^9}, {3.7355561282926435`*^9, 3.7355561535325756`*^9}, {
   3.7355749511158257`*^9, 3.735574964744487*^9}, {3.735575043724048*^9, 
   3.735575107867568*^9}, {3.7356313302155404`*^9, 3.7356314110243883`*^9}, {
   3.7356314592811995`*^9, 3.735631524146886*^9}, {3.7356316721096754`*^9, 
   3.7356316723630605`*^9}, {3.7357357699298687`*^9, 3.735735775304886*^9}, 
   3.73649368495747*^9, 3.736494062043361*^9, {3.7364941183738832`*^9, 
   3.73649414782216*^9}, 3.7364941815913954`*^9, {3.736494670999565*^9, 
   3.736494672858943*^9}, {3.736571844152792*^9, 3.7365718506701417`*^9}, {
   3.7365719634111133`*^9, 3.736571994174186*^9}, {3.736572166653339*^9, 
   3.736572167971347*^9}, {3.736572366895255*^9, 3.736572370082748*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"e1a573d7-6a95-4653-9b36-27dce1c3e278"],

Cell["Text", "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 
  3.7313961250085583`*^9}},ExpressionUUID->"3a540760-2a0f-4f9e-b876-\
3a34a1b2b3ba"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Metropolis-Hastings Algorithm", "Section",
 CellChangeTimes->{{3.7311485456128216`*^9, 3.731148566553211*^9}, {
  3.7311728763702154`*^9, 3.731172876585377*^9}, {3.734767021695509*^9, 
  3.734767028429741*^9}},ExpressionUUID->"6b64f766-2d6f-4b53-b40b-\
fa2c6dfc2ff6"],

Cell["Text", "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 
  3.7313961250085583`*^9}},ExpressionUUID->"eb9a74f9-b6ef-429d-ae83-\
92fb89967539"],

Cell[CellGroupData[{

Cell["Algorithm", "Subsection",
 CellChangeTimes->{{3.7313136105953646`*^9, 3.7313136348285203`*^9}, 
   3.7313961390776787`*^9, {3.7347670461329994`*^9, 
   3.7347670481955194`*^9}},ExpressionUUID->"6fa987bc-30f7-47da-9025-\
5c67c6e34962"],

Cell["Text", "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 
  3.7313961250085583`*^9}},ExpressionUUID->"1572f5a2-6dc0-4d52-a2b8-\
6c3ac30dff2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"samplingDescription", "[", "list_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"mean", "=", 
       RowBox[{"Mean", "[", "list", "]"}]}], ",", 
      RowBox[{"standardDeviation", "=", 
       RowBox[{"StandardDeviation", "[", "list", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Mean: \>\"", ",", " ", 
        RowBox[{"N", "[", "mean", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Std: \>\"", ",", " ", 
        RowBox[{"N", "[", "standardDeviation", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Median: \>\"", ",", 
        RowBox[{"N", "[", 
         RowBox[{"Median", "[", "list", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Quantiles: \>\"", ",", " ", 
        RowBox[{"N", "[", 
         RowBox[{"Quantile", "[", 
          RowBox[{"list", ",", 
           RowBox[{"{", 
            RowBox[{"0.025", ",", "0.05", ",", "0.95", ",", "0.975"}], 
            "}"}]}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Confidence interval: \>\"", ",", " ", 
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"mean", "-", 
            RowBox[{"2", "standardDeviation"}]}], "]"}], ",", " ", 
          RowBox[{"N", "[", 
           RowBox[{"mean", "+", 
            RowBox[{"2", "standardDeviation"}]}], "]"}]}], "}"}]}], "}"}]}], 
     "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7344341678097897`*^9, 3.7344343027004447`*^9}, {
   3.734674457936862*^9, 3.734674458874365*^9}, {3.7347684406113453`*^9, 
   3.7347684924708543`*^9}, {3.73476868903327*^9, 3.734768704064523*^9}, 
   3.736495259534771*^9, {3.736495314224171*^9, 3.736495319817871*^9}, {
   3.7364954082165337`*^9, 3.736495418207209*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"fffb1614-bf7c-4e98-be99-4371790c202e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metropolisHastings", "[", 
   RowBox[{
   "function_", ",", "start_", ",", "distribution_", ",", "iterations_", ",", 
    "burnin_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"list", "=", 
      RowBox[{"{", "start", "}"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"previous", "=", 
            RowBox[{"Last", "[", "list", "]"}]}], ",", 
           RowBox[{"proposal", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"RandomVariate", "[", 
                RowBox[{"distribution", "[", "#", "]"}], "]"}], "&"}], ",", 
              RowBox[{"Last", "[", "list", "]"}]}], "]"}]}], ",", 
           RowBox[{"threshold", "=", 
            RowBox[{"RandomReal", "[", "]"}]}]}], "}"}], ",", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"proposedValue", "=", 
             RowBox[{"function", "[", "proposal", "]"}]}], "}"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Element", "[", 
               RowBox[{"proposedValue", ",", "Reals"}], "]"}], "&&", 
              RowBox[{"proposedValue", ">", 
               RowBox[{"threshold", " ", 
                RowBox[{"function", "[", "previous", "]"}]}]}]}], ",", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"list", ",", "proposal"}], "]"}], ",", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"list", ",", "previous"}], "]"}]}], "]"}]}], "]"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "iterations"}], "}"}]}], "]"}], ";", 
     RowBox[{"list", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", "+", "burnin"}], ";;", 
        RowBox[{"Length", "[", "list", "]"}]}], "]"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.735446802623561*^9, 3.735446813563817*^9}, 
   3.736495266835306*^9, {3.7364954225509634`*^9, 3.736495446215002*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"6bfcdedc-e37f-4f12-8988-19454ce033fb"],

Cell["Text", "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 
  3.7313961250085583`*^9}},ExpressionUUID->"dff6eaf6-c740-420a-b9ae-\
d33e913e8aeb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", "Subsection",
 CellChangeTimes->{{3.7313136105953646`*^9, 3.7313136348285203`*^9}, 
   3.7313961390776787`*^9, {3.7347670507736425`*^9, 
   3.7347670521017723`*^9}},ExpressionUUID->"0adcd58b-aab2-490a-a6ac-\
6cb68724e650"],

Cell["Text", "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 
  3.7313961250085583`*^9}},ExpressionUUID->"473a5bee-2143-4645-9e02-\
8d00131556fa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gibbsSampling", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"NormalDistribution", "[", 
      RowBox[{"0", ",", "1"}], "]"}], ",", "10000"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"samplingDescription", "[", "gibbsSampling", "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Histogram", "[", 
         RowBox[{"gibbsSampling", ",", "30", ",", "\"\<PDF\>\""}], "]"}], ",", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"PDF", "[", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", 
             RowBox[{"0", ",", "1"}], "]"}], ",", "x"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0.4"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "350"}]}], "]"}], ",", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"SmoothHistogram", "[", "gibbsSampling", "]"}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0.4"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "350"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.734673953040533*^9, 3.73467411479071*^9}, {
  3.7346741869782324`*^9, 3.7346743585149574`*^9}, {3.7346744658743734`*^9, 
  3.734674469327511*^9}, {3.734674632379953*^9, 3.7346746343175993`*^9}, {
  3.734674665911354*^9, 3.7346746830049667`*^9}, {3.7346750866458273`*^9, 
  3.7346751003645844`*^9}, {3.7347670792762814`*^9, 3.7347671173122764`*^9}, {
  3.7354482025735254`*^9, 3.7354482071138773`*^9}, {3.735449502914421*^9, 
  3.735449503129835*^9}, {3.7364952591012926`*^9, 3.736495284776021*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"ef3c24bf-4cad-486c-9b3c-c2892df9ade1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"metropolisHastingsSampling", "=", 
   RowBox[{"metropolisHastings", "[", 
    RowBox[{
     RowBox[{"PDF", "[", 
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "1", "}"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"x", ",", "0.3"}], "]"}]}], "]"}], ",", "10000", ",", "0"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"samplingDescription", "[", "metropolisHastingsSampling", "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Histogram", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "metropolisHastingsSampling", "]"}], ",", 
          "30", ",", "\"\<PDF\>\""}], "]"}], ",", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"PDF", "[", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", 
             RowBox[{"0", ",", "1"}], "]"}], ",", "x"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0.4"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "350"}]}], "]"}], ",", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"SmoothHistogram", "[", 
       RowBox[{"Flatten", "[", "metropolisHastingsSampling", "]"}], "]"}], 
      ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0.4"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "350"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.734674373577482*^9, 3.7346744742806077`*^9}, {
   3.7346745842912025`*^9, 3.734674618181972*^9}, {3.7346746693800964`*^9, 
   3.7346747023957405`*^9}, {3.73467476684888*^9, 3.734674784379996*^9}, {
   3.7346748210520053`*^9, 3.734674821411394*^9}, {3.734674860177026*^9, 
   3.734674891473765*^9}, {3.7346749590831547`*^9, 3.7346749847862873`*^9}, {
   3.734675114927075*^9, 3.7346751500988255`*^9}, {3.734675183052894*^9, 
   3.734675193381015*^9}, {3.734767102671683*^9, 3.7347671130780454`*^9}, {
   3.734768034460701*^9, 3.7347680349920964`*^9}, {3.734768545486395*^9, 
   3.7347685482677383`*^9}, {3.7347686189239035`*^9, 
   3.7347686267990108`*^9}, {3.735042235382596*^9, 3.7350422680076647`*^9}, {
   3.735042298900191*^9, 3.735042329674783*^9}, 3.7350425196281137`*^9, {
   3.7350434862235346`*^9, 3.735043488834121*^9}, {3.7350643352521467`*^9, 
   3.735064387033258*^9}, {3.7354468781806087`*^9, 3.7354469074807453`*^9}, {
   3.735447029896304*^9, 3.7354470515811715`*^9}, {3.735447086380553*^9, 
   3.735447087480936*^9}, {3.7354471288978195`*^9, 3.735447163299759*^9}, {
   3.7354482161975365`*^9, 3.7354482197467957`*^9}, {3.7354494998138127`*^9, 
   3.7354495000807905`*^9}, {3.7364952591012926`*^9, 3.7364952663665867`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"90865b3e-5949-4057-9f9a-35901ebd95e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gibbsSampling2D", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"MultinormalDistribution", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", "10000"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"samplingDescription", "[", "gibbsSampling2D", "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"Histogram3D", "[", 
       RowBox[{"gibbsSampling2D", ",", "30", ",", "\"\<PDF\>\""}], "]"}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0.16"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "350"}]}], "]"}], ",", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"SmoothHistogram3D", "[", "gibbsSampling2D", "]"}], ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0.16"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "350"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.734673953040533*^9, 3.73467411479071*^9}, {
  3.7346741869782324`*^9, 3.7346743585149574`*^9}, {3.7346744658743734`*^9, 
  3.734674469327511*^9}, {3.734674632379953*^9, 3.7346746343175993`*^9}, {
  3.734674665911354*^9, 3.7346746830049667`*^9}, {3.7347671581248565`*^9, 
  3.7347671880154257`*^9}, {3.7364952591012926`*^9, 3.7364952820728965`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"d6ebdd83-b966-4d44-a03b-58adfbe1bf19"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"metropolisHastingsSampling2D", "=", 
   RowBox[{"metropolisHastings", "[", 
    RowBox[{
     RowBox[{"PDF", "[", 
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"x", ",", "0.3"}], "]"}]}], "]"}], ",", "10000", ",", "0"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"samplingDescription", "[", "metropolisHastingsSampling2D", "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"Histogram3D", "[", 
       RowBox[{
       "metropolisHastingsSampling2D", ",", "30", ",", "\"\<PDF\>\""}], "]"}],
       ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0.16"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "350"}]}], "]"}], ",", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"SmoothHistogram3D", "[", "metropolisHastingsSampling2D", "]"}],
       ",", 
      RowBox[{"PlotRange", "->", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0.16"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "350"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.734674373577482*^9, 3.7346744742806077`*^9}, {
   3.7346745842912025`*^9, 3.734674618181972*^9}, {3.7346746693800964`*^9, 
   3.7346747023957405`*^9}, {3.73467476684888*^9, 3.734674784379996*^9}, {
   3.7346748210520053`*^9, 3.734674821411394*^9}, {3.734674860177026*^9, 
   3.734674891473765*^9}, {3.7346749590831547`*^9, 3.7346749847862873`*^9}, 
   3.7346752030997734`*^9, {3.7347671626405516`*^9, 3.7347671856249337`*^9}, {
   3.7347675844761877`*^9, 3.7347675846482115`*^9}, {3.7350642958656206`*^9, 
   3.7350643186895075`*^9}, {3.7354472162306013`*^9, 
   3.7354472195173492`*^9}, {3.7354479761305294`*^9, 
   3.7354479780957017`*^9}, {3.736495259116883*^9, 3.7364952663821836`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"a990f015-7534-4d07-b31a-df2287d8ccd4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gibbsSampling", "=", 
   RowBox[{"RandomVariate", "[", 
    RowBox[{
     RowBox[{"BetaDistribution", "[", 
      RowBox[{"33", ",", "67"}], "]"}], ",", "10000"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"samplingDescription", "[", "gibbsSampling", "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Histogram", "[", 
         RowBox[{"gibbsSampling", ",", "30", ",", "\"\<PDF\>\""}], "]"}], ",", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"PDF", "[", 
           RowBox[{
            RowBox[{"BetaDistribution", "[", 
             RowBox[{"33", ",", "67"}], "]"}], ",", "x"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "All"}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "350"}]}], "]"}], ",", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"SmoothHistogram", "[", "gibbsSampling", "]"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "All"}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "350"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.734673953040533*^9, 3.73467411479071*^9}, {
   3.7346741869782324`*^9, 3.7346743585149574`*^9}, {3.7346744658743734`*^9, 
   3.734674469327511*^9}, {3.734674632379953*^9, 3.7346746343175993`*^9}, {
   3.734674665911354*^9, 3.7346746830049667`*^9}, {3.7346750866458273`*^9, 
   3.7346751003645844`*^9}, {3.7347670792762814`*^9, 
   3.7347671173122764`*^9}, {3.735447368513906*^9, 3.7354473799975576`*^9}, {
   3.735448063364066*^9, 3.735448110447378*^9}, {3.7354493392645426`*^9, 
   3.7354493962526693`*^9}, 3.735449482564145*^9, {3.736495259116883*^9, 
   3.7364952820728965`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"310d5584-fa8b-480c-ba73-0ab686b1a24b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"metropolisHastingsSampling", "=", 
   RowBox[{"metropolisHastings", "[", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"PDF", "[", 
        RowBox[{
         RowBox[{"BetaDistribution", "[", 
          RowBox[{"33", ",", "67"}], "]"}], ",", 
         RowBox[{"x", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", "0.5", "}"}], ",", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "x", "}"}], ",", 
       RowBox[{"BetaDistribution", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"10", "^", 
           RowBox[{"-", "2"}]}], "+", 
          RowBox[{"100", "x"}]}], ",", 
         RowBox[{
          RowBox[{"10", "^", 
           RowBox[{"-", "2"}]}], "+", 
          RowBox[{"100", 
           RowBox[{"(", 
            RowBox[{"1", "-", "x"}], ")"}]}]}]}], "]"}]}], "]"}], ",", 
     "10000", ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"samplingDescription", "[", "metropolisHastingsSampling", "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Row", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Histogram", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "metropolisHastingsSampling", "]"}], ",", 
          "30", ",", "\"\<PDF\>\""}], "]"}], ",", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"PDF", "[", 
           RowBox[{
            RowBox[{"BetaDistribution", "[", 
             RowBox[{"33", ",", "67"}], "]"}], ",", "x"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "All"}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "350"}]}], "]"}], ",", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"SmoothHistogram", "[", 
       RowBox[{"Flatten", "[", "metropolisHastingsSampling", "]"}], "]"}], 
      ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "All"}], "}"}]}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "350"}]}], "]"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7354492365186844`*^9, 3.7354492453805876`*^9}, {
   3.735449282247225*^9, 3.735449313908244*^9}, {3.735449416656438*^9, 
   3.735449421164014*^9}, 3.7354494932318134`*^9, {3.736495259116883*^9, 
   3.7364952663821836`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"a47af384-b280-4cea-bd2d-ddac1f4051ed"],

Cell["Text", "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 
  3.7313961250085583`*^9}},ExpressionUUID->"c8fdecc0-b41c-449a-ba48-\
9655e93b1688"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["SUGM Parameter Estimation", "Section",
 CellChangeTimes->{{3.7311485456128216`*^9, 3.731148566553211*^9}, {
  3.7311728763702154`*^9, 3.731172876585377*^9}, {3.7347687870178213`*^9, 
  3.7347687934239264`*^9}},ExpressionUUID->"a67244df-8005-4608-a14c-\
56ecb05cccd7"],

Cell[TextData[{
 "The original articles describing SUGM contain two methods to estimate the \
parameters of the model. The current research suggests a third, more \
intuitive method based on the subgraph census. In a ",
 StyleBox["k",
  FontSlant->"Italic"],
 "-subgraph census, a network of ",
 StyleBox["n",
  FontSlant->"Italic"],
 " nodes is grouped into all possible subsets of ",
 StyleBox["k",
  FontSlant->"Italic"],
 " nodes, which are then tallied according to their isomorphism class [7, 8, \
9]."
}], "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 3.7313961250085583`*^9}, {
  3.7362379532418528`*^9, 3.736237962911622*^9}, {3.736241601833735*^9, 
  3.7362416179015417`*^9}},ExpressionUUID->"386481d8-6253-42aa-ac36-\
1781ccafba7b"],

Cell[CellGroupData[{

Cell["Generic Functions", "Subsection",
 CellChangeTimes->{{3.7313136105953646`*^9, 3.7313136348285203`*^9}, 
   3.7313961390776787`*^9, {3.734768800377195*^9, 
   3.7347688028302975`*^9}},ExpressionUUID->"a0a1012f-96e9-417d-878e-\
a6ade2b6d680"],

Cell["Text", "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 
  3.7313961250085583`*^9}},ExpressionUUID->"2cf3dd60-df5e-4e4a-a1cd-\
e27f4562c9a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateAllSubgraphPermutations", "[", 
   RowBox[{"n_", ",", "k_", ",", "m_"}], "]"}], ":=", 
  RowBox[{"DeleteDuplicates", "[", 
   RowBox[{"Map", "[", 
    RowBox[{"Sort", ",", 
     RowBox[{"Map", "[", 
      RowBox[{"m", ",", 
       RowBox[{"Permutations", "[", 
        RowBox[{
         RowBox[{"Range", "[", "n", "]"}], ",", 
         RowBox[{"{", "k", "}"}]}], "]"}]}], "]"}], ",", "2"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.736572974607221*^9, 3.736573023848273*^9}, {
   3.73657308757421*^9, 3.736573088902338*^9}, 3.736574466168213*^9},
 CellLabel->"In[88]:=",ExpressionUUID->"7b16d529-e568-43b3-ac6d-dd0cdc0ad237"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEquationCases", "[", "l_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"1", "<", "l", "<", "5"}], ",", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"keys", "=", 
        RowBox[{"Keys", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"subgraphNodes", ",", 
           RowBox[{
            RowBox[{"#", "\[LessEqual]", "l"}], "&"}]}], "]"}], "]"}]}], 
       "}"}], ",", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"allSubgraphPermutations", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"generateAllSubgraphPermutations", "[", 
              RowBox[{"l", ",", 
               RowBox[{"subgraphNodes", "[", "#", "]"}], ",", 
               RowBox[{"subgraphEdgeMap", "[", "#", "]"}]}], "]"}], "&"}], 
            ",", "keys"}], "]"}]}], "}"}], ",", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"allSubgraphs", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"allSubgraphPermutations", ",", "1"}], "]"}]}], ",", 
            RowBox[{"allSubgraphPermutationSizes", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Map", "[", 
               RowBox[{"Length", ",", "allSubgraphPermutations"}], "]"}], 
              "]"}]}]}], "}"}], ",", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"variableList", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Symbol", "[", 
                 RowBox[{"\"\<i\>\"", "<>", 
                  RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "[", "allSubgraphs", "]"}]}], "}"}]}], 
               "]"}]}], "}"}], ",", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"iteratorList", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"variableList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"False", ",", "True"}], "}"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", "variableList", "]"}]}], "}"}]}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"iteratorSequence", "=", 
                  RowBox[{"Replace", "[", 
                   RowBox[{"iteratorList", ",", 
                    RowBox[{
                    RowBox[{"head_", "[", "arg__", "]"}], "\[RuleDelayed]", 
                    RowBox[{"Sequence", "[", "arg", "]"}]}]}], "]"}]}], "}"}],
                 ",", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"generationConfiguration", "=", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{"variableList", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"allSubgraphPermutationSizes", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", 
                    RowBox[{"i", "-", "1"}]}], "]"}], "]"}], "]"}], "+", 
                    "j"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"allSubgraphPermutationSizes", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", "keys", "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"Union", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Pick", "[", 
                    RowBox[{"allSubgraphs", ",", "variableList"}], "]"}], 
                    "]"}], "]"}]}], "}"}], ",", "iteratorSequence"}], "]"}], 
                    ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "variableList", "]"}], "-", 
                    "1"}]}], "]"}]}], "}"}], ",", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"groupedConfiguration", "=", 
                    RowBox[{"GroupBy", "[", 
                    RowBox[{"generationConfiguration", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sort", "[", 
                    RowBox[{"Total", "[", 
                    RowBox[{"SparseArray", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "[", "#", "]"}], "\[Equal]", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", "}"}], "}"}], ",", 
                    RowBox[{"AdjacencyMatrix", "[", 
                    RowBox[{"Last", "[", "#", "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"l", ",", "l"}], "}"}]}], "]"}], "]"}], "]"}], 
                    "&"}], "\[Rule]", "First"}]}], "]"}]}], "}"}], ",", 
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Symbol", "[", 
                    RowBox[{"\"\<no\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "keys", "]"}], "]"}]}], "}"}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{"Simplify", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", "x", "}"}], ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", "y", "}"}], ",", 
                    RowBox[{"Product", "[", 
                    RowBox[{
                    RowBox[{"ReplaceAll", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Exp", "[", "y", "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"False", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"\"\<no\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], ",", 
                    RowBox[{"True", "\[Rule]", 
                    RowBox[{"Log", "[", 
                    RowBox[{"1", "-", 
                    RowBox[{"\"\<no\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}]}], "]"}]}]}], 
                    "}"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Range", "[", 
                    RowBox[{"Length", "[", "keys", "]"}], "]"}]}], "}"}]}], 
                    "]"}]}], "]"}], ",", "x"}], "]"}], "]"}]}], "]"}], ",", 
                    "groupedConfiguration"}], "]"}]}], "]"}], "]"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
         "]"}]}], "]"}]}], "]"}], ",", 
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"Association", "[", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7364967955060115`*^9, 3.736496854448243*^9}, {
   3.7364969145328856`*^9, 3.736496925907531*^9}, 3.7364970293158765`*^9, {
   3.7364971707310314`*^9, 3.736497251137683*^9}, {3.7364973472752147`*^9, 
   3.7364973494322147`*^9}, {3.736497428945939*^9, 3.73649743560894*^9}, {
   3.7364974902979345`*^9, 3.7364976112720847`*^9}, {3.736497644729001*^9, 
   3.7364976797840757`*^9}, {3.7364978694802523`*^9, 
   3.7364978748382263`*^9}, {3.736498260845643*^9, 3.736498386556619*^9}, {
   3.736498466372965*^9, 3.736498480268013*^9}, {3.7364985585911036`*^9, 
   3.736498613340499*^9}, {3.7364988940982156`*^9, 3.7364989140901794`*^9}, {
   3.736500157886263*^9, 3.736500186373262*^9}, {3.7365002403002987`*^9, 
   3.7365002615962934`*^9}, {3.736500366987862*^9, 3.7365004144828634`*^9}, {
   3.736500448730834*^9, 3.73650057296386*^9}, {3.7365006089638295`*^9, 
   3.7365007439068594`*^9}, {3.7365007908448277`*^9, 3.73650096322725*^9}, {
   3.73650273634017*^9, 3.73650274334717*^9}, {3.7365039339451103`*^9, 
   3.7365040063433475`*^9}, {3.7365040543932133`*^9, 3.736504161559738*^9}, {
   3.73650446464437*^9, 3.7365044689723473`*^9}, {3.7365044992519617`*^9, 
   3.7365045847069173`*^9}, {3.736504698605336*^9, 3.736504914594898*^9}, {
   3.7365049595244064`*^9, 3.7365049643367567`*^9}, {3.7365052186471715`*^9, 
   3.736505237745076*^9}, {3.7365053235539675`*^9, 3.736505397154221*^9}, {
   3.7365054367892036`*^9, 3.7365054864354534`*^9}, {3.7365055718054576`*^9, 
   3.7365056829091697`*^9}, {3.7365057432287693`*^9, 
   3.7365057436505337`*^9}, {3.7365058180677104`*^9, 3.736505904076806*^9}, {
   3.7365060037225533`*^9, 3.7365060496744227`*^9}, 3.7365732816939087`*^9, {
   3.736574370855321*^9, 3.7365743992520075`*^9}, {3.736574444697195*^9, 
   3.736574500265644*^9}, {3.7365748366071*^9, 3.736574872935117*^9}, 
   3.7365756108052635`*^9, 3.7365758213761597`*^9, {3.736575859384513*^9, 
   3.73657588850473*^9}, {3.7365760143263626`*^9, 3.736576035448202*^9}, {
   3.736576132618034*^9, 3.736576139987219*^9}, {3.736576228509235*^9, 
   3.7365762289446597`*^9}, {3.7365791062795315`*^9, 
   3.7365791193932657`*^9}, {3.7365792054086266`*^9, 3.736579253928975*^9}, {
   3.736579294596522*^9, 3.73657940971406*^9}, {3.7365794798824854`*^9, 
   3.7365794864138756`*^9}, {3.7365795258236427`*^9, 
   3.7365795739930544`*^9}, {3.7365796411915607`*^9, 
   3.7365797278400316`*^9}, {3.7365797795366106`*^9, 
   3.7365798223199167`*^9}, {3.7365798638366737`*^9, 
   3.7365798796902027`*^9}, {3.736579923131738*^9, 3.7365799278940015`*^9}, {
   3.7365799686686964`*^9, 3.736579997942546*^9}, {3.736580038523924*^9, 
   3.736580076979636*^9}, {3.7365801198983164`*^9, 3.7365802043370085`*^9}, {
   3.736580259617394*^9, 3.736580264188281*^9}, {3.7365803460027337`*^9, 
   3.736580426718544*^9}, {3.7365804642014303`*^9, 3.736580466670038*^9}, {
   3.7365808729911823`*^9, 3.7365809075755076`*^9}, {3.736580999145253*^9, 
   3.7365810058159156`*^9}, {3.7365811331535854`*^9, 3.736581190490867*^9}, {
   3.7365812729781733`*^9, 3.7365812918688664`*^9}, {3.7365813630834208`*^9, 
   3.736581384050808*^9}, {3.7365815991027*^9, 3.7365816506145525`*^9}, {
   3.7365816925878415`*^9, 3.7365817138885636`*^9}, {3.736581794670971*^9, 
   3.736581805951063*^9}, {3.7365818426485214`*^9, 3.73658184453665*^9}, {
   3.7365819378656006`*^9, 3.7365819461897354`*^9}, {3.7365820566936507`*^9, 
   3.736582059662393*^9}, {3.7365821149649134`*^9, 3.7365821628194838`*^9}, {
   3.7365821964096146`*^9, 3.736582283281908*^9}, {3.7365823165554724`*^9, 
   3.736582347631957*^9}, {3.736582446595965*^9, 3.7365824596787252`*^9}, 
   3.7365825443670034`*^9, {3.7365825985630364`*^9, 3.73658263658941*^9}, {
   3.7365833782368517`*^9, 3.7365834926126013`*^9}, {3.7365835900599623`*^9, 
   3.7365837049136076`*^9}, {3.7365837509428244`*^9, 3.7365837584862785`*^9}},
 CellLabel->
  "In[286]:=",ExpressionUUID->"2d59eb91-547d-4882-b398-da8a140972ce"],

Cell[BoxData[{
 RowBox[{"generateEquationCases", "[", "1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"generateEquationCases", "[", "2", "]"}], "\[IndentingNewLine]", 
 RowBox[{"generateEquationCases", "[", "3", 
  "]"}], "\[IndentingNewLine]", "\"\<generateEquationCases[4] very slow\>\"", \
"\[IndentingNewLine]", 
 RowBox[{"generateEquationCases", "[", "5", "]"}]}], "Input",
 CellChangeTimes->{
  3.7365834303498845`*^9, {3.7365834625976934`*^9, 3.7365834657689376`*^9}, {
   3.7365834963313446`*^9, 3.7365835035852985`*^9}, {3.736583547797284*^9, 
   3.736583550172142*^9}, {3.736583723406395*^9, 3.7365837466259975`*^9}, {
   3.7365838186697116`*^9, 3.7365838242322226`*^9}, {3.7365840902575116`*^9, 
   3.7365841013986883`*^9}},
 CellLabel->
  "In[321]:=",ExpressionUUID->"78c1f7a0-591a-4546-8c53-02049b84d8c3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"subgraphEquationCases", "=", 
   RowBox[{"Association", "[", 
    RowBox[{
     RowBox[{"2", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "noLink", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", "noLink", ")"}], ",", 
          RowBox[{"(", 
           RowBox[{"1", "-", "noLink"}], ")"}]}], "}"}]}], "]"}]}], ",", 
     RowBox[{"3", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"noLink", ",", "noPath", ",", "noTriangle"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", "noTriangle", ")"}], 
           RowBox[{
            RowBox[{"(", "noPath", ")"}], "^", "3"}], 
           RowBox[{
            RowBox[{"(", "noLink", ")"}], "^", "3"}]}], ",", 
          RowBox[{"3", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", "noTriangle", ")"}], 
             RowBox[{
              RowBox[{"(", "noPath", ")"}], "^", "3"}], 
             RowBox[{
              RowBox[{"(", "noLink", ")"}], "^", "2"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", "noLink"}], ")"}]}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"3", 
            RowBox[{"(", "noTriangle", ")"}], 
            RowBox[{
             RowBox[{"(", "noPath", ")"}], "^", "3"}], 
            RowBox[{"(", "noLink", ")"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "noLink"}], ")"}], "^", "2"}]}], "+", 
           RowBox[{"3", 
            RowBox[{"(", "noTriangle", ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "noPath"}], ")"}], 
            RowBox[{
             RowBox[{"(", "noPath", ")"}], "^", "2"}], 
            RowBox[{"(", "noLink", ")"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", "noTriangle", ")"}], 
            RowBox[{
             RowBox[{"(", "noPath", ")"}], "^", "3"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "noLink"}], ")"}], "^", "3"}]}], "+", 
           RowBox[{"3", 
            RowBox[{"(", "noTriangle", ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "noPath"}], ")"}], 
            RowBox[{
             RowBox[{"(", "noPath", ")"}], "^", "2"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "noLink"}], ")"}]}], "+", 
           RowBox[{"3", 
            RowBox[{"(", "noTriangle", ")"}], 
            RowBox[{"(", "noPath", ")"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "noPath"}], ")"}], "^", "2"}]}], "+", 
           RowBox[{
            RowBox[{"(", "noTriangle", ")"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "noPath"}], ")"}], "^", "3"}]}], "+", 
           RowBox[{"(", 
            RowBox[{"1", "-", "noTriangle"}], ")"}]}]}], "}"}]}], "]"}]}], 
     ",", 
     RowBox[{"4", "\[Rule]", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"noLink", ",", "noPath", ",", "noTriangle", ",", "noStar"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", "noStar", ")"}], "^", "4"}], 
           RowBox[{
            RowBox[{"(", "noTriangle", ")"}], "^", "4"}], 
           RowBox[{
            RowBox[{"(", "noPath", ")"}], "^", "4"}], 
           RowBox[{
            RowBox[{"(", "noLink", ")"}], "^", "6"}]}], ",", 
          RowBox[{"6", 
           RowBox[{
            RowBox[{"(", "noStar", ")"}], "^", "4"}], 
           RowBox[{
            RowBox[{"(", "noTriangle", ")"}], "^", "4"}], 
           RowBox[{
            RowBox[{"(", "noPath", ")"}], "^", "4"}], 
           RowBox[{
            RowBox[{"(", "noLink", ")"}], "^", "5"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "noLink"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"12", 
            RowBox[{
             RowBox[{"(", "noStar", ")"}], "^", "4"}], 
            RowBox[{
             RowBox[{"(", "noTriangle", ")"}], "^", "4"}], 
            RowBox[{
             RowBox[{"(", "noPath", ")"}], "^", "4"}], 
            RowBox[{
             RowBox[{"(", "noLink", ")"}], "^", "4"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "noLink"}], ")"}], "^", "2"}]}], "+", 
           RowBox[{"12", 
            RowBox[{
             RowBox[{"(", "noStar", ")"}], "^", "4"}], 
            RowBox[{
             RowBox[{"(", "noTriangle", ")"}], "^", "4"}], 
            RowBox[{
             RowBox[{"(", "noPath", ")"}], "^", "3"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "noPath"}], ")"}], 
            RowBox[{
             RowBox[{"(", "noLink", ")"}], "^", "4"}]}]}], ",", 
          RowBox[{
           RowBox[{"4", 
            RowBox[{
             RowBox[{"(", "noStar", ")"}], "^", "4"}], 
            RowBox[{
             RowBox[{"(", "noTriangle", ")"}], "^", "4"}], 
            RowBox[{
             RowBox[{"(", "noPath", ")"}], "^", "4"}], 
            RowBox[{
             RowBox[{"(", "noLink", ")"}], "^", "3"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "noLink"}], ")"}], "^", "3"}]}], "+", 
           RowBox[{"4", 
            RowBox[{
             RowBox[{"(", "noStar", ")"}], "^", "4"}], 
            RowBox[{
             RowBox[{"(", "noTriangle", ")"}], "^", "3"}], 
            RowBox[{
             RowBox[{"(", "noPath", ")"}], "^", "4"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "noTriangle"}], ")"}], 
            RowBox[{
             RowBox[{"(", "noLink", ")"}], "^", "3"}]}]}], ",", 
          RowBox[{"3", 
           RowBox[{
            RowBox[{"(", "noTriangle", ")"}], "^", "4"}], 
           RowBox[{
            RowBox[{"(", "noLink", ")"}], "^", "4"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "noLink"}], ")"}], "^", "2"}]}], ",", 
          RowBox[{"12", 
           RowBox[{
            RowBox[{"(", "noTriangle", ")"}], "^", "4"}], 
           RowBox[{
            RowBox[{"(", "noLink", ")"}], "^", "3"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "noLink"}], ")"}], "^", "3"}]}], ",", 
          RowBox[{"4", 
           RowBox[{
            RowBox[{"(", "noTriangle", ")"}], "^", "4"}], 
           RowBox[{
            RowBox[{"(", "noLink", ")"}], "^", "3"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "noLink"}], ")"}], "^", "3"}]}], ",", 
          RowBox[{
           RowBox[{"12", 
            RowBox[{
             RowBox[{"(", "noTriangle", ")"}], "^", "4"}], 
            RowBox[{
             RowBox[{"(", "noLink", ")"}], "^", "2"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "noLink"}], ")"}], "^", "4"}]}], "+", 
           RowBox[{"12", 
            RowBox[{
             RowBox[{"(", "noTriangle", ")"}], "^", "3"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "noTriangle"}], ")"}], 
            RowBox[{
             RowBox[{"(", "noLink", ")"}], "^", "2"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "noLink"}], ")"}], "^", "1"}]}]}], ",", 
          RowBox[{"3", 
           RowBox[{
            RowBox[{"(", "noTriangle", ")"}], "^", "4"}], 
           RowBox[{
            RowBox[{"(", "noLink", ")"}], "^", "2"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "noLink"}], ")"}], "^", "4"}]}], ",", 
          RowBox[{
           RowBox[{"6", 
            RowBox[{
             RowBox[{"(", "noTriangle", ")"}], "^", "4"}], 
            RowBox[{
             RowBox[{"(", "noLink", ")"}], "^", "1"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "noLink"}], ")"}], "^", "5"}]}], "+", 
           RowBox[{"12", 
            RowBox[{
             RowBox[{"(", "noTriangle", ")"}], "^", "3"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "noTriangle"}], ")"}], 
            RowBox[{
             RowBox[{"(", "noLink", ")"}], "^", "1"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "noLink"}], ")"}], "^", "2"}]}], "+", 
           RowBox[{"6", 
            RowBox[{
             RowBox[{"(", "noTriangle", ")"}], "^", "2"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "noTriangle"}], ")"}], "^", "2"}], 
            RowBox[{
             RowBox[{"(", "noLink", ")"}], "^", "1"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", "noTriangle", ")"}], "^", "4"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "noLink"}], ")"}], "^", "6"}]}], "+", 
           RowBox[{"4", 
            RowBox[{
             RowBox[{"(", "noTriangle", ")"}], "^", "3"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "noTriangle"}], ")"}], "^", "1"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "noLink"}], ")"}], "^", "3"}]}], "+", 
           RowBox[{"6", 
            RowBox[{
             RowBox[{"(", "noTriangle", ")"}], "^", "2"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "noTriangle"}], ")"}], "^", "2"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "noLink"}], ")"}], "^", "1"}]}], "+", 
           RowBox[{"4", 
            RowBox[{
             RowBox[{"(", "noTriangle", ")"}], "^", "1"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "noTriangle"}], ")"}], "^", "3"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "noTriangle"}], ")"}], "^", "4"}]}]}], "}"}]}],
        "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"KeyValueMap", "[", 
  RowBox[{
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"type", ",", "equationCases"}], "}"}], ",", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Total", "[", 
       RowBox[{"equationCases", "[", 
        RowBox[{"q1", ",", "0", ",", "0", ",", "0"}], "]"}], "]"}], "]"}]}], 
    "]"}], ",", "subgraphEquationCases"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"KeyValueMap", "[", 
  RowBox[{
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"type", ",", "equationCases"}], "}"}], ",", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Total", "[", 
       RowBox[{"equationCases", "[", 
        RowBox[{"0", ",", "q2", ",", "0", ",", "0"}], "]"}], "]"}], "]"}]}], 
    "]"}], ",", "subgraphEquationCases"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"KeyValueMap", "[", 
  RowBox[{
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"type", ",", "equationCases"}], "}"}], ",", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Total", "[", 
       RowBox[{"equationCases", "[", 
        RowBox[{"0", ",", "0", ",", "q3", ",", "0"}], "]"}], "]"}], "]"}]}], 
    "]"}], ",", "subgraphEquationCases"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"KeyValueMap", "[", 
  RowBox[{
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"type", ",", "equationCases"}], "}"}], ",", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Total", "[", 
       RowBox[{"equationCases", "[", 
        RowBox[{"q1", ",", "q2", ",", "q3", ",", "q4"}], "]"}], "]"}], 
      "]"}]}], "]"}], ",", "subgraphEquationCases"}], "]"}]}], "Input",
 CellChangeTimes->{{3.735274368850149*^9, 3.7352744170843754`*^9}, {
   3.735274471397018*^9, 3.735274472193903*^9}, {3.735274731187422*^9, 
   3.735274731890546*^9}, {3.735276426626341*^9, 3.735276437829598*^9}, {
   3.7352794407371035`*^9, 3.7352794560027285`*^9}, {3.7352805695051613`*^9, 
   3.7352805826145406`*^9}, 3.736496080070368*^9, {3.7364961530212*^9, 
   3.7364962232810993`*^9}, 3.73649632675124*^9, 3.736496430055595*^9, {
   3.7364964673017187`*^9, 3.736496482846489*^9}, {3.7364965572142224`*^9, 
   3.736496564503049*^9}, {3.736496620849249*^9, 3.736496640623375*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"eb9b9ac0-9058-4c91-9061-6d9303eaa1b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"keySort", "[", "keys_", "]"}], ":=", 
  RowBox[{"Sort", "[", 
   RowBox[{"keys", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"First", "[", 
       RowBox[{"First", "[", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Keys", "[", "subgraphNodes", "]"}], ",", "#1"}], "]"}], 
        "]"}], "]"}], "<", 
      RowBox[{"First", "[", 
       RowBox[{"First", "[", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Keys", "[", "subgraphNodes", "]"}], ",", "#2"}], "]"}], 
        "]"}], "]"}]}], "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7353707243385105`*^9, 3.735370732054475*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"5c7531cb-7d0a-4d52-9639-738b8e5811b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateSubgraphs", "[", "l_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"l", "<", "5"}], ",", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"allGraphs", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"matrix", "=", 
              RowBox[{"Table", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "l"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", "l"}], "}"}]}], "]"}]}], "}"}], 
            ",", 
            RowBox[{
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"matrix", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                RowBox[{"list", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"l", " ", "i"}], "-", 
                   RowBox[{"Binomial", "[", 
                    RowBox[{"i", ",", "2"}], "]"}], "-", "j", "+", "1"}], 
                  "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"l", "-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"i", "+", "1"}], ",", "l"}], "}"}]}], "]"}], ";", 
             RowBox[{"matrix", "=", 
              RowBox[{"matrix", "+", 
               RowBox[{"Transpose", "[", "matrix", "]"}]}]}], ";", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sort", "[", 
                RowBox[{"Total", "[", "matrix", "]"}], "]"}], ",", "matrix"}],
               "}"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"list", ",", 
            RowBox[{"Tuples", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              RowBox[{"Binomial", "[", 
               RowBox[{"l", ",", "2"}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
       "}"}], ",", 
      RowBox[{
       RowBox[{"GatherBy", "[", 
        RowBox[{"allGraphs", ",", "First"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"{", "0", "}"}], "}"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7348405315655317`*^9, 3.7348405375500765`*^9}, {
   3.734840579261116*^9, 3.7348405898006983`*^9}, {3.7348406218340216`*^9, 
   3.734840649283715*^9}, 3.734840700033992*^9, {3.7354571287225294`*^9, 
   3.735457130613143*^9}, {3.7354571767381763`*^9, 3.7354571787069144`*^9}, {
   3.7354617466608105`*^9, 3.735461765394739*^9}, {3.735462346310484*^9, 
   3.7354624526228695`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"5020d4d8-f762-41d3-80f9-a413285ec3b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"subgraphTypeLength", "[", "l_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"l", "<", "5"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "11"}], "}"}], "[", 
     RowBox[{"[", "l", "]"}], "]"}], ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7352747875938272`*^9, 3.735274797921802*^9}, {
  3.735461039374705*^9, 3.7354610412967176`*^9}, {3.735462362122986*^9, 
  3.735462364076113*^9}, {3.7354625831726384`*^9, 3.735462590125774*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"79409510-5555-41a8-a42b-5487d631d517"],

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", "figureList", "}"}], ",", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Subgraph types: \>\"", ",", 
           RowBox[{"subgraphTypeLength", "[", "l", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<Subgraphs: \>\"", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"l", "<", "5"}], ",", 
             RowBox[{"Row", "[", 
              RowBox[{"figureList", "=", 
               RowBox[{"Map", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"AdjacencyGraph", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{
                    "GraphLayout", "\[Rule]", "\"\<CircularEmbedding\>\""}], 
                    ",", 
                    RowBox[{"ImagePadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"8", ",", "8"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "8"}], "}"}]}], "}"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], "&"}], 
                 ",", 
                 RowBox[{"generateSubgraphs", "[", "l", "]"}]}], "]"}]}], 
              "]"}], ",", 
             "\"\<The algorithm uses DegreeSquence to identify subgraphs. \
This is only valid for subgraphs with less than 5 nodes \
(http://mathworld.wolfram.com/DegreeSequence.html).\>\""}], "]"}]}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"2", ",", "2"}], "}"}]}]}], "]"}], ",", 
     RowBox[{"Grid", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Control", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"l", ",", "3", ",", "\"\<Subgraph size\>\""}], "}"}], 
            ",", 
            RowBox[{"Range", "[", "5", "]"}]}], "}"}], "]"}], ",", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Export Figure 3\>\"", ",", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "<>", 
                 "\"\<\\\\Figure03_\>\"", "<>", 
                 RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.pdf\>\""}], 
                ",", 
                RowBox[{"figureList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "figureList", "]"}]}], "}"}]}], "]"}]}],
           "]"}]}], "}"}], "}"}], "]"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7354596518738437`*^9, 3.735459784233262*^9}, {
   3.735459971920841*^9, 3.735460076780085*^9}, {3.7354601775146446`*^9, 
   3.735460282577188*^9}, {3.7354603129051695`*^9, 3.735460313905306*^9}, {
   3.7354603591240873`*^9, 3.735460417388708*^9}, {3.735461052593459*^9, 
   3.735461062702982*^9}, {3.7354615385339246`*^9, 3.7354615440495424`*^9}, {
   3.73546246563865*^9, 3.735462552047614*^9}, 3.7354626565981326`*^9, {
   3.7357360174118237`*^9, 3.7357360367243166`*^9}, {3.736052041568481*^9, 
   3.736052045190166*^9}, {3.736052800983588*^9, 3.7360528118874316`*^9}, {
   3.736052875272599*^9, 3.736052945023676*^9}, {3.7360530199841805`*^9, 
   3.73605313143056*^9}, {3.7360531704751186`*^9, 3.736053174014703*^9}, {
   3.7360537600248337`*^9, 3.7360537773128777`*^9}, 3.736053855217415*^9, {
   3.7360719928505154`*^9, 3.736072044745329*^9}, {3.736072105571279*^9, 
   3.7360721909321404`*^9}, {3.73649498624448*^9, 3.7364949871193457`*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"caaf14cd-fc0c-48cf-b2e5-18646fd8c426"],

Cell[BoxData[
 RowBox[{
  RowBox[{"countSubgraphs", "[", 
   RowBox[{"l_", ",", "n_", ",", "edgeList_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"adjacencyMatrix", "=", 
       RowBox[{"SparseArray", "[", 
        RowBox[{
         RowBox[{"AdjacencyMatrix", "[", "edgeList", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"variableList", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Symbol", "[", 
           RowBox[{"\"\<i\>\"", "<>", 
            RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], ",", 
         RowBox[{"Range", "[", "l", "]"}]}], "]"}]}]}], "}"}], ",", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"iteratorSequence", "=", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"variableList", "[", 
                RowBox[{"[", "#", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", "0", "}"}], ",", "variableList"}], "]"}], "[", 
                 RowBox[{"[", "#", "]"}], "]"}], "+", "1"}], ",", 
               RowBox[{"n", "-", "l", "+", "#"}]}], "}"}], "&"}], ",", 
            RowBox[{"Range", "[", "l", "]"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"head_", "[", "arg__", "]"}], "\[RuleDelayed]", 
           RowBox[{"Sequence", "[", "arg", "]"}]}]}], "]"}]}], "}"}], ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"counts", "=", 
          RowBox[{"Association", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Sort", "[", 
                RowBox[{"Total", "[", "#", "]"}], "]"}], "\[Rule]", "0"}], 
              "&"}], ",", 
             RowBox[{"generateSubgraphs", "[", "l", "]"}]}], "]"}], "]"}]}], 
         "}"}], ",", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"counts", "[", 
             RowBox[{"Sort", "[", 
              RowBox[{"Total", "[", 
               RowBox[{"adjacencyMatrix", "[", 
                RowBox[{"[", 
                 RowBox[{"variableList", ",", "variableList"}], "]"}], "]"}], 
               "]"}], "]"}], "]"}], "++"}], ",", "iteratorSequence"}], "]"}], 
         ";", "counts"}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.733718225046564*^9, 3.7337182685316153`*^9}, {
   3.733718306742591*^9, 3.7337185254918365`*^9}, {3.7337185719394064`*^9, 
   3.7337186260584354`*^9}, 3.733719992559498*^9, 3.733720442980399*^9, 
   3.7337204967894154`*^9, {3.7337205744364367`*^9, 3.7337206026844482`*^9}, 
   3.7337206582524676`*^9, {3.7337207218355055`*^9, 3.7337207402194924`*^9}, {
   3.7337217152630215`*^9, 3.733721718502021*^9}, {3.7337217789680653`*^9, 
   3.7337218173022056`*^9}, {3.733721911966092*^9, 3.733722023102254*^9}, {
   3.7337221205813713`*^9, 3.7337221452373433`*^9}, {3.7337222620933805`*^9, 
   3.7337224223154316`*^9}, {3.7337225872364864`*^9, 3.733722588259486*^9}, {
   3.7337241656525073`*^9, 3.733724184339546*^9}, {3.7337242527385693`*^9, 
   3.733724263595565*^9}, {3.7337246249636526`*^9, 3.733724632305674*^9}, {
   3.7337246714906673`*^9, 3.733724671920701*^9}, {3.733725177976241*^9, 
   3.7337252634722624`*^9}, 3.73527748451897*^9, {3.735277521129609*^9, 
   3.735277534041196*^9}, {3.7364954643193407`*^9, 3.736495467585436*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"f47e83b6-6a28-4fc5-86c4-5122a025481f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"estimateLikelihood", "[", 
   RowBox[{
   "n_", ",", "counts_", ",", "equations_", ",", "likelihoods_", ",", 
    "precisions_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"likelihoodsReduced", "=", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", "ps", "}"}], ",", 
        RowBox[{"Evaluate", "[", 
         RowBox[{"Quiet", "[", 
          RowBox[{"likelihoods", "[", 
           RowBox[{"n", ",", "ps", ",", "counts"}], "]"}], "]"}], "]"}]}], 
       "]"}]}], "}"}], ",", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"variableList", "=", 
        RowBox[{"Variables", "[", 
         RowBox[{"Last", "[", 
          RowBox[{"Quiet", "[", 
           RowBox[{"likelihoodsReduced", "[", "ps", "]"}], "]"}], "]"}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"maxLikelihood", "=", 
          RowBox[{"NArgMax", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"likelihoodsReduced", "[", "variableList", "]"}], ",", 
              RowBox[{"0", "<", "variableList", "<", "0.5"}]}], "}"}], ",", 
            "variableList"}], "]"}]}], "}"}], ",", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"logPrecision", "=", 
             RowBox[{"Quiet", "[", 
              RowBox[{"-", 
               RowBox[{"Log", "[", 
                RowBox[{"-", 
                 RowBox[{"precisions", "[", 
                  RowBox[{"n", ",", "maxLikelihood", ",", "counts"}], "]"}]}],
                 "]"}]}], "]"}]}], ",", 
            RowBox[{"expectedCounts", "=", 
             RowBox[{"equations", "[", 
              RowBox[{"n", ",", "maxLikelihood"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"Grid", "[", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Maximum likelihood: \>\"", ",", "maxLikelihood"}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<Goodness of fit: \>\"", ",", 
                  RowBox[{"Mean", "[", 
                   RowBox[{"MapThread", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#1", "<", "#2"}], ",", 
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "#1"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "#2"}], ")"}]}]}], "-", "1"}], ",", 
                    RowBox[{
                    RowBox[{"2", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "#2"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "#1"}], ")"}]}]}], "-", "1"}]}], "]"}], 
                    "&"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"counts", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "counts", "]"}], 
                    "expectedCounts"}]}], "}"}]}], "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<-Log[-Precision]: \>\"", ",", "logPrecision"}], 
                 "}"}]}], "}"}], ",", 
              RowBox[{"samplingDescription", "[", 
               RowBox[{"metropolisHastings", "[", 
                RowBox[{"likelihoodsReduced", ",", "maxLikelihood", ",", 
                 RowBox[{"Function", "[", 
                  RowBox[{
                   RowBox[{"{", "x", "}"}], ",", 
                   RowBox[{"BetaDistribution", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "2"}]}], "+", 
                    RowBox[{"1000", "x"}]}], ",", 
                    RowBox[{
                    RowBox[{"10", "^", 
                    RowBox[{"-", "2"}]}], "+", 
                    RowBox[{"1000", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "x"}], ")"}]}]}]}], "]"}]}], "]"}], ",", 
                 RowBox[{"10000", 
                  RowBox[{"Length", "[", "variableList", "]"}]}], ",", "0"}], 
                "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"Spacings", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], "]"}]}], "]"}]}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7348413695411153`*^9, 3.7348413919675217`*^9}, {
   3.734841422025948*^9, 3.734841422351342*^9}, {3.7348414543530765`*^9, 
   3.734841454901239*^9}, {3.734841530670024*^9, 3.734841530915455*^9}, {
   3.7348450791174335`*^9, 3.734845127933775*^9}, {3.734845257701926*^9, 
   3.734845266017824*^9}, {3.734845466367338*^9, 3.7348455376004453`*^9}, {
   3.7348455895837083`*^9, 3.7348456050005646`*^9}, {3.734847486804532*^9, 
   3.7348475438272057`*^9}, {3.7348476577341213`*^9, 
   3.7348478309475236`*^9}, {3.7350206241465025`*^9, 3.73502071990738*^9}, {
   3.7350281022974596`*^9, 3.7350281030941787`*^9}, {3.73502815433222*^9, 
   3.7350281628376126`*^9}, {3.7350284061985197`*^9, 3.735028437456747*^9}, {
   3.735028519385786*^9, 3.735028520854538*^9}, {3.735028555056635*^9, 
   3.7350285569630146`*^9}, {3.735028670417948*^9, 3.7350286763646545`*^9}, {
   3.735030451916094*^9, 3.7350304899787955`*^9}, {3.7350310135318527`*^9, 
   3.735031030994496*^9}, {3.7350329463317194`*^9, 3.7350329465457673`*^9}, {
   3.7350333121364*^9, 3.7350333209468036`*^9}, {3.7350354172056923`*^9, 
   3.735035422445413*^9}, {3.735035649052846*^9, 3.7350356515684724`*^9}, {
   3.7350357916221185`*^9, 3.735035813596781*^9}, {3.735037848263956*^9, 
   3.7350378555296087`*^9}, {3.7350379576214433`*^9, 3.735037960558823*^9}, {
   3.7350380711243496`*^9, 3.735038105216382*^9}, {3.7350405020113745`*^9, 
   3.735040518897925*^9}, {3.7350407614963613`*^9, 3.7350407647533445`*^9}, {
   3.7350408427634916`*^9, 3.7350408523544006`*^9}, {3.7350409440167484`*^9, 
   3.7350409456117783`*^9}, {3.7350416831155744`*^9, 3.735041685293721*^9}, {
   3.7350418111896057`*^9, 3.7350418416683445`*^9}, {3.735043701381558*^9, 
   3.7350437135083246`*^9}, {3.7350443400753484`*^9, 3.735044340891649*^9}, {
   3.7350650051857285`*^9, 3.735065032591831*^9}, {3.7350650815450983`*^9, 
   3.735065125841837*^9}, {3.7350652618418407`*^9, 3.735065279951212*^9}, {
   3.7350663985754147`*^9, 3.735066525247283*^9}, {3.7350667725344477`*^9, 
   3.73506677620647*^9}, {3.7350670231719007`*^9, 3.735067024906411*^9}, {
   3.7350673299376755`*^9, 3.7350673313126755`*^9}, {3.7350673718125305`*^9, 
   3.735067374500032*^9}, {3.73511328257766*^9, 3.7351132827597003`*^9}, {
   3.7351133240006533`*^9, 3.7351133363693247`*^9}, {3.7353597561322403`*^9, 
   3.7353597614106445`*^9}, {3.735361638323146*^9, 3.73536164679177*^9}, {
   3.735448006798401*^9, 3.735448009480666*^9}, {3.735448384230728*^9, 
   3.7354483866645975`*^9}, {3.7354577598633623`*^9, 3.7354578189726443`*^9}, 
   3.7354670282839737`*^9, {3.735468772360389*^9, 3.735468785907267*^9}, {
   3.735469022153014*^9, 3.735469024793604*^9}, {3.7355342951160493`*^9, 
   3.7355343169185376`*^9}, {3.7355352719112177`*^9, 3.735535291348213*^9}, {
   3.7355354855388737`*^9, 3.735535488351227*^9}, {3.7355355493802967`*^9, 
   3.735535552208284*^9}, {3.7355355912483835`*^9, 3.735535610058448*^9}, {
   3.735535767006852*^9, 3.7355357682566977`*^9}, {3.735536128216129*^9, 
   3.735536156590424*^9}, {3.735747189201001*^9, 3.735747194388363*^9}, {
   3.7364952591325407`*^9, 3.736495266397805*^9}, {3.736495514406537*^9, 
   3.736495528246684*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"95565ad1-9ffa-4fb7-8714-63a9f427d30a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeHistogram", "[", 
   RowBox[{"l_", ",", "n_", ",", "f_", ",", "counts_"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"expectedMean", "=", 
       RowBox[{
        RowBox[{"Binomial", "[", 
         RowBox[{"n", ",", "l"}], "]"}], "f"}]}], ",", 
      RowBox[{"expectedStandardDeviation", "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"Binomial", "[", 
          RowBox[{"n", ",", "l"}], "]"}], " ", "f", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "f"}], ")"}]}], "]"}]}]}], "}"}], ",", 
    RowBox[{"Grid", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Mean: \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"N", "[", 
           RowBox[{"Mean", "[", "counts", "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Std: \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"N", "[", 
           RowBox[{"StandardDeviation", "[", "counts", "]"}], "]"}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"Histogram", "[", 
           RowBox[{"counts", ",", "Automatic", ",", "\"\<PDF\>\""}], "]"}], 
          ",", 
          RowBox[{"DiscretePlot", "[", 
           RowBox[{
            RowBox[{"PDF", "[", 
             RowBox[{
              RowBox[{"BinomialDistribution", "[", 
               RowBox[{"n", ",", "f"}], "]"}], ",", "k"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"Floor", "[", 
               RowBox[{"expectedMean", "-", 
                RowBox[{"2", "expectedStandardDeviation"}]}], "]"}], ",", 
              RowBox[{"Ceiling", "[", 
               RowBox[{"expectedMean", "+", 
                RowBox[{"2", "expectedStandardDeviation"}]}], "]"}]}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"PDF", "[", 
             RowBox[{
              RowBox[{"NormalDistribution", "[", 
               RowBox[{"expectedMean", ",", "expectedStandardDeviation"}], 
               "]"}], ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"expectedMean", "-", 
               RowBox[{"2", "expectedStandardDeviation"}]}], " ", ",", 
              RowBox[{"expectedMean", "+", 
               RowBox[{"2", "expectedStandardDeviation"}]}]}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}], "}"}]}], "}"}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.731300913777424*^9, 3.7313009543129945`*^9}, {
   3.731301181337264*^9, 3.7313012051210556`*^9}, {3.731301286942284*^9, 
   3.7313013499370203`*^9}, {3.731301532176286*^9, 3.7313015983239794`*^9}, {
   3.7313016604897594`*^9, 3.7313016961341934`*^9}, {3.7313018156152496`*^9, 
   3.7313018453682957`*^9}, {3.731301964872801*^9, 3.7313019652167253`*^9}, {
   3.7313021035913568`*^9, 3.7313021393921785`*^9}, {3.731302388293776*^9, 
   3.7313024780533695`*^9}, {3.7313026641610217`*^9, 3.731302702165084*^9}, {
   3.731302756639654*^9, 3.7313027664688196`*^9}, {3.7313027985503635`*^9, 
   3.731302801160035*^9}, {3.731304470797889*^9, 3.7313044730793743`*^9}, {
   3.7313047831474876`*^9, 3.731304904071822*^9}, {3.7313060750567355`*^9, 
   3.7313060936679697`*^9}, {3.7313186424511538`*^9, 3.731318651733404*^9}, {
   3.7313187057800694`*^9, 3.7313187096712437`*^9}, {3.731393109205428*^9, 
   3.7313931187571855`*^9}, {3.731393201310568*^9, 3.731393203940565*^9}, {
   3.7313932403070903`*^9, 3.731393252659262*^9}, {3.7313932975692368`*^9, 
   3.731393298268198*^9}, {3.731393352087734*^9, 3.7313933892781153`*^9}, {
   3.7313934916849256`*^9, 3.7313934926272573`*^9}, {3.7313935381889534`*^9, 
   3.7313935383600893`*^9}, {3.731393588343184*^9, 3.731393628799574*^9}, {
   3.731393714947275*^9, 3.731393731514054*^9}, {3.7313939891211243`*^9, 
   3.731394032109823*^9}, {3.731394086178258*^9, 3.73139408745649*^9}, {
   3.7313941584123588`*^9, 3.7313941634336753`*^9}, {3.731413019265785*^9, 
   3.7314130211566114`*^9}, {3.731413171914709*^9, 3.7314131874837513`*^9}, {
   3.7314132176641316`*^9, 3.7314132212281218`*^9}, {3.731413492642608*^9, 
   3.731413510488865*^9}, 3.731492481579705*^9, {3.732030200463811*^9, 
   3.732030201966612*^9}, {3.7354578381446533`*^9, 3.7354578386602645`*^9}, {
   3.735457883332015*^9, 3.7354578969102755`*^9}, 3.735464633524702*^9, {
   3.7354672140872374`*^9, 3.73546722018099*^9}, {3.735467707754939*^9, 
   3.7354677099580793`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"adeca30f-f28f-40de-85fe-2fbb1901961f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"exponentGenerator", "[", 
   RowBox[{"n_", ",", "p_", ",", "l_", ",", "cases_"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         RowBox[{
          RowBox[{"Binomial", "[", 
           RowBox[{"n", ",", "2"}], "]"}], "/", 
          RowBox[{"Binomial", "[", 
           RowBox[{"n", ",", "l"}], "]"}]}], "p"}]}], ")"}], "^", "#"}], 
     "&"}], ",", "cases"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.734769910448643*^9, {3.7347699875016947`*^9, 3.7347699877360682`*^9}, {
   3.734770020833612*^9, 3.734770021192988*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"1e61f050-4ff7-4775-9a92-f4c97c814bfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"equationGenerator", "[", 
   RowBox[{
   "subgraphNodes_", ",", "subgraphCases_", ",", "subgraphEquationCases_"}], 
   "]"}], ":=", 
  RowBox[{"AssociationMap", "[", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", "l", "}"}], ",", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"exponentiatedCases", "=", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", "p", "}"}], ",", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"exponentGenerator", "[", 
                 RowBox[{"n", ",", "p", ",", "#1", ",", 
                  RowBox[{"#2", "[", "n", "]"}]}], "]"}], "]"}]}], "]"}], 
             "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"subgraphNodes", ",", 
              RowBox[{"subgraphCases", "[", "l", "]"}]}], "}"}]}], "]"}]}], 
         "}"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"Evaluate", "[", 
              RowBox[{"{", 
               RowBox[{"n", ",", "ps"}], "}"}], "]"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{
               RowBox[{"subgraphEquationCases", "[", "l", "]"}], "[", 
               RowBox[{"ReplaceAll", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{"List", "\[Rule]", "Sequence"}], "}"}]}], "]"}], 
               "]"}], "]"}]}], "]"}], "&"}], ",", 
          RowBox[{"AssociationMap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Product", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"exponentiatedCases", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "[", 
                RowBox[{"Quiet", "[", 
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"ps", ",", "i"}], "]"}], ",", 
                  RowBox[{"{", 
                   StyleBox[
                    RowBox[{"Part", "::", "partd"}], "MessageName"], "}"}]}], 
                 "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "#", "]"}]}], "}"}]}], "]"}], "&"}], 
            ",", 
            RowBox[{"Subsets", "[", 
             RowBox[{
              RowBox[{"Keys", "[", "exponentiatedCases", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"Length", "[", "exponentiatedCases", "]"}], ",", 
                  RowBox[{
                   RowBox[{"subgraphTypeLength", "[", "l", "]"}], "-", 
                   "1"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
       "]"}]}], "]"}], ",", "subgraphSizes"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7352756031379924`*^9, 3.735275639528492*^9}, {
   3.7352756903879957`*^9, 3.735275742528637*^9}, {3.735275937754409*^9, 
   3.735275939488785*^9}, {3.7352759823792744`*^9, 3.7352759846917763`*^9}, 
   3.7352762960170965`*^9, {3.7352764584114733`*^9, 3.7352764608647337`*^9}, {
   3.7352765424091535`*^9, 3.7352765461747694`*^9}, {3.7353666949348097`*^9, 
   3.735366720995802*^9}, {3.7353667543924093`*^9, 3.7353667576111565`*^9}, {
   3.735366881558025*^9, 3.73536690293606*^9}, {3.7353669330207*^9, 
   3.735366940764683*^9}, {3.7353690726656895`*^9, 3.735369101151944*^9}, {
   3.735369240917036*^9, 3.735369249567311*^9}, 3.7353698146454477`*^9, {
   3.7353698457556343`*^9, 3.7353698465837746`*^9}, {3.7353808512441854`*^9, 
   3.7353808533930397`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"4aeb1401-5e32-48c7-bacb-45d2ec78dbb8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"likelihoodGenerator", "[", "equations_", "]"}], ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"KeyValueMap", "[", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"type", ",", "equationsPerType"}], "}"}], ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"countList", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Quiet", "[", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"counts", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                StyleBox[
                 RowBox[{"Part", "::", "partd"}], "MessageName"], "}"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"subgraphTypeLength", "[", "type", "]"}]}], "}"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"type", "\[Rule]", 
          RowBox[{"Association", "[", 
           RowBox[{"KeyValueMap", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"key", ",", "equation"}], "}"}], ",", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"pList", "=", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Quiet", "[", 
                    RowBox[{
                    RowBox[{"Part", "[", 
                    RowBox[{"ps", ",", "i"}], "]"}], ",", 
                    RowBox[{"{", 
                    StyleBox[
                    RowBox[{"Part", "::", "partd"}], "MessageName"], "}"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", "key", "]"}]}], "}"}]}], "]"}]}], 
                  "}"}], ",", 
                 RowBox[{"key", "->", 
                  RowBox[{"Function", "[", 
                   RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "ps", ",", "counts"}], "}"}], "]"}], 
                    ",", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Times", ",", 
                    RowBox[{
                    RowBox[{"equation", "[", 
                    RowBox[{"n", ",", "pList"}], "]"}], "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Binomial", "[", 
                    RowBox[{"n", ",", "2"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Binomial", "[", 
                    RowBox[{"n", ",", "type"}], "]"}], 
                    RowBox[{"Binomial", "[", 
                    RowBox[{"type", ",", "2"}], "]"}]}], " ", ")"}]}], 
                    "countList"}], ")"}]}]}], "]"}], "]"}]}], "]"}]}]}], 
                "]"}]}], "]"}], ",", "equationsPerType"}], "]"}], "]"}]}]}], 
        "]"}]}], "]"}], ",", "equations"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.735367015974065*^9, {3.7353693067984924`*^9, 3.7353693399728484`*^9}, {
   3.7353693849239683`*^9, 3.7353693870646067`*^9}, {3.735369448513337*^9, 
   3.7353694496165895`*^9}, {3.7353694918069105`*^9, 3.735369730396118*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"f58c7147-c401-4f20-9710-c90eef4a5973"],

Cell[BoxData[
 RowBox[{
  RowBox[{"precisionGenerator", "[", "likelihoods_", "]"}], ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"KeyValueMap", "[", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"type", ",", "likelihoodsPerType"}], "}"}], ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"countList", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Quiet", "[", 
              RowBox[{
               RowBox[{"Part", "[", 
                RowBox[{"counts", ",", "i"}], "]"}], ",", 
               RowBox[{"{", 
                StyleBox[
                 RowBox[{"Part", "::", "partd"}], "MessageName"], "}"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"subgraphTypeLength", "[", "type", "]"}]}], "}"}]}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"type", "\[Rule]", 
          RowBox[{"Association", "[", 
           RowBox[{"KeyValueMap", "[", 
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"key", ",", "likelihood"}], "}"}], ",", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"pList", "=", 
                   RowBox[{"Variables", "[", 
                    RowBox[{"likelihood", "[", 
                    RowBox[{"1", ",", "ps", ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"subgraphTypeLength", "[", "type", "]"}]}], 
                    "}"}]}], "]"}]}], "]"}], "]"}]}], "}"}], ",", 
                 RowBox[{"key", "->", 
                  RowBox[{"Function", "[", 
                   RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "ps", ",", "counts"}], "}"}], "]"}], 
                    ",", 
                    RowBox[{"Evaluate", "[", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", "var1", "}"}], ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{
                    RowBox[{"{", "var2", "}"}], ",", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"likelihood", "[", 
                    RowBox[{"n", ",", "pList", ",", "countList"}], "]"}], ",",
                     "var1", ",", "var2"}], "]"}]}], "]"}], ",", "pList"}], 
                    "]"}]}], "]"}], ",", "pList"}], "]"}], "]"}]}], "]"}]}]}],
                 "]"}]}], "]"}], ",", "likelihoodsPerType"}], "]"}], 
           "]"}]}]}], "]"}]}], "]"}], ",", "likelihoods"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7352749430625896`*^9, 3.7352750316093564`*^9}, {
   3.7352767535029297`*^9, 3.7352767553934126`*^9}, {3.7352767876591873`*^9, 
   3.7352767945185485`*^9}, {3.7353617473202744`*^9, 
   3.7353617539459157`*^9}, {3.735361797045932*^9, 3.735361820032308*^9}, {
   3.7353618597960367`*^9, 3.7353618625148067`*^9}, {3.7354580262540836`*^9, 
   3.7354580263633175`*^9}, {3.7354580739572325`*^9, 
   3.7354580888009863`*^9}, {3.7354582126604013`*^9, 
   3.7354582962541733`*^9}, {3.735458351707325*^9, 3.735458431191718*^9}, {
   3.735458472504232*^9, 3.7354586196917953`*^9}, {3.73545865223867*^9, 
   3.7354587255668435`*^9}, 3.735458789379343*^9, {3.735458866160627*^9, 
   3.7354589039104943`*^9}, {3.7354590134575562`*^9, 
   3.7354590704263053`*^9}, {3.7354591126450644`*^9, 3.7354591155980654`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"ec9ae38a-9847-47dd-9916-b2dbae746fad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"columnExpectedGenerator", "[", "equations_", "]"}], ":=", 
  RowBox[{"Association", "[", 
   RowBox[{"KeyValueMap", "[", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"type", ",", "equationsPerType"}], "}"}], ",", 
       RowBox[{"type", "\[Rule]", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "equation", "}"}], ",", 
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"n", ",", "ps"}], "}"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Grid", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<Count: \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"Binomial", "[", 
                    RowBox[{"n", ",", "type"}], "]"}], "#"}], "]"}]}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Std: \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{
                    RowBox[{"Binomial", "[", 
                    RowBox[{"n", ",", "type"}], "]"}], " ", "#", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "#"}], ")"}]}], "]"}], "]"}]}], "}"}]}],
                    "}"}], "]"}], "&"}], ",", 
                RowBox[{"equation", "[", 
                 RowBox[{"n", ",", "ps"}], "]"}]}], "]"}]}], "]"}]}], "]"}], 
          ",", "equationsPerType"}], "]"}]}]}], "]"}], ",", "equations"}], 
    "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.735370918000594*^9, 3.735371064436266*^9}, {
  3.7354673988771687`*^9, 3.735467406361414*^9}, {3.7354676429424253`*^9, 
  3.735467649942428*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"d32e9cd1-d009-44bd-a964-f046c4a20a63"],

Cell["Text", "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 
  3.7313961250085583`*^9}},ExpressionUUID->"41504ec6-94a7-4288-b675-\
676cb91286fa"]
}, Closed]],

Cell[CellGroupData[{

Cell["Subgraph Simulations", "Subsection",
 CellChangeTimes->{{3.7313136105953646`*^9, 3.7313136348285203`*^9}, 
   3.7353639674740095`*^9, {3.736572676118946*^9, 
   3.736572678040842*^9}},ExpressionUUID->"26eec612-f744-4cde-86ff-\
36987006f50f"],

Cell[TextData[{
 "The table below contains the probabilities of observing any of the possible \
triads for three different generation models. In general, each of the ",
 StyleBox["r",
  FontSlant->"Italic"],
 " counts of the census ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", "j"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "054721ee-ce56-421c-8283-d9fe58e8e60d"],
 ", together with the probability functions ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "j"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "6308e2fc-ba29-4ab0-938b-9460a6e4f674"],
 "(",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["p", "^"], "1"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "78a1505f-bc5f-4cfe-b6ae-cbd2078dac67"],
 ",...,",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["p", "^"], "l"], TraditionalForm]],ExpressionUUID->
  "81dafa79-6b09-48da-a4dd-2c3e31eadc5f"],
 "), enter into the multinomial probability mass function to form the \
likelihood function. This can be used to estimate the parameters of the model \
and their confidence intervals."
}], "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 3.7313961250085583`*^9}, {
  3.7362379812980385`*^9, 3.7362379901979485`*^9}, {3.7362416304714537`*^9, 
  3.7362416807710543`*^9}, {3.7362417329754915`*^9, 3.7362417373495755`*^9}, {
  3.7362417789368477`*^9, 
  3.7362418297692933`*^9}},ExpressionUUID->"75d9e694-79d0-4d87-90ed-\
4bdd80a32aa2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"subgraphEquations", "=", 
   RowBox[{"equationGenerator", "[", 
    RowBox[{
    "subgraphNodes", ",", "subgraphCases", ",", "subgraphEquationCases"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.735275110731691*^9, 3.735275113294199*^9}, {
   3.735275423841095*^9, 3.735275424091091*^9}, {3.735275780481762*^9, 
   3.7352757855755177`*^9}, {3.735276182895054*^9, 3.7352761912075624`*^9}, 
   3.735276568299779*^9, 3.735359162443801*^9, 3.7353592127562666`*^9, {
   3.735361868367427*^9, 3.735361871929908*^9}, {3.7353659936141357`*^9, 
   3.735366002520336*^9}, 3.735366563145329*^9, {3.7353667305509524`*^9, 
   3.735366731519698*^9}, {3.7353669450146666`*^9, 3.7353669778077726`*^9}, {
   3.735369271322112*^9, 3.7353692787126117`*^9}, {3.735369965688987*^9, 
   3.735369969907599*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"0a7d89ec-f1df-432f-97a2-8575ef91e55a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"subgraphLikelihoods", "=", 
   RowBox[{"likelihoodGenerator", "[", "subgraphEquations", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7352765988622837`*^9, 3.735276606471657*^9}, {
   3.7352766852685394`*^9, 3.7352767127684517`*^9}, {3.735359214339942*^9, 
   3.7353592162917166`*^9}, 3.7353618692580347`*^9, 3.7353619390895386`*^9, 
   3.7353659989733534`*^9, {3.7353665252146225`*^9, 3.7353665258552527`*^9}, 
   3.735366560989085*^9, {3.7353697376762133`*^9, 3.7353697502857294`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"84b8c709-f3bb-4db4-ae91-4a77e64d1f07"],

Cell[BoxData[
 RowBox[{
  RowBox[{"subgraphPrecisions", "=", 
   RowBox[{"precisionGenerator", "[", "subgraphLikelihoods", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7354588449574833`*^9, 3.7354588510668592`*^9}, 
   3.735459202676372*^9},
 CellLabel->"In[59]:=",ExpressionUUID->"ee2c8855-72d7-4a64-a0b7-627de7014fd2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"subgraphExpected", "=", 
   RowBox[{"columnExpectedGenerator", "[", "subgraphEquations", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.735370887896298*^9, {3.7353710687487745`*^9, 3.735371102499424*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"3b6bbdbe-5fae-4734-93cd-60d1191d0637"],

Cell[BoxData[
 RowBox[{
  RowBox[{"subgraphGrid", "[", 
   RowBox[{
   "l_", ",", "generationTypes_", ",", "modelTypes_", ",", "n_", ",", "pMap_",
     ",", "t_", ",", "equations_", ",", "counts_", ",", "countsList_", ",", 
    "singleAnalysis_", ",", "multipleAnalysis_"}], "]"}], ":=", 
  RowBox[{"Which", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "generationTypes", "]"}], "<", "1"}], "||", 
     RowBox[{
      RowBox[{"Length", "[", "modelTypes", "]"}], "<", "1"}]}], ",", 
    "\"\<Model undetermined: please choose at least one generation and model \
type.\>\"", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "generationTypes", "]"}], ">=", 
      RowBox[{"subgraphTypeLength", "[", "l", "]"}]}], "||", 
     RowBox[{
      RowBox[{"Length", "[", "modelTypes", "]"}], ">=", 
      RowBox[{"subgraphTypeLength", "[", "l", "]"}]}]}], ",", 
    "\"\<Model overfit: please choose fewer generation and model types, or \
select a higher subgraph size.\>\"", ",", "True", ",", 
    RowBox[{"Quiet", "[", 
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pList", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Symbol", "[", 
             RowBox[{"\"\<p\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "pMap", "]"}]}], "}"}]}], "]"}]}], "}"}],
         ",", 
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", "\"\<Subgraph\>\"", "}"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"AdjacencyGraph", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{
                   "GraphLayout", "\[Rule]", "\"\<CircularEmbedding\>\""}]}], 
                  "]"}], "&"}], ",", 
                RowBox[{"generateSubgraphs", "[", "l", "]"}]}], "]"}], ",", 
              RowBox[{"{", "\"\<Total\>\"", "}"}]}], "]"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Row", "[", 
                RowBox[{"generationTypes", ",", "\"\<&\>\""}], "]"}], "}"}], 
              ",", 
              RowBox[{
               RowBox[{
                RowBox[{"subgraphEquations", "[", "l", "]"}], "[", 
                RowBox[{"keySort", "[", "generationTypes", "]"}], "]"}], "[", 
               RowBox[{"\"\<n\>\"", ",", "pList"}], "]"}], ",", 
              RowBox[{"{", "\"\<1\>\"", "}"}]}], "]"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", "\"\<Expected\>\"", "}"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"subgraphExpected", "[", "l", "]"}], "[", 
                RowBox[{"keySort", "[", "generationTypes", "]"}], "]"}], "[", 
               RowBox[{"n", ",", 
                RowBox[{"Values", "[", "pMap", "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Binomial", "[", 
                RowBox[{"n", ",", "l"}], "]"}], "}"}]}], "]"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", "\"\<Single\>\"", "}"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\"\<Count: \>\"", "<>", 
                  RowBox[{"ToString", "[", "#", "]"}]}], "&"}], ",", 
                "counts"}], "]"}], ",", 
              RowBox[{"{", "singleAnalysis", "}"}]}], "]"}], ",", 
            RowBox[{"Quiet", "[", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "\"\<Multiple\>\"", "}"}], ",", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"makeHistogram", "[", 
                   RowBox[{"l", ",", "n", ",", "#1", ",", "#2"}], "]"}], 
                  "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"equations", "[", "l", "]"}], "[", 
                    RowBox[{"Keys", "[", "pMap", "]"}], "]"}], "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"Values", "[", "pMap", "]"}]}], "]"}], ",", 
                   RowBox[{"Transpose", "[", "countsList", "]"}]}], "}"}]}], 
                "]"}], ",", 
               RowBox[{"{", "multipleAnalysis", "}"}]}], "]"}], "]"}]}], 
           "}"}], ",", 
          RowBox[{"Frame", "\[Rule]", "All"}], ",", 
          RowBox[{"Spacings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"2", ",", "3"}], "}"}]}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       StyleBox[
        RowBox[{"Part", "::", "partw"}], "MessageName"], "}"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7353638791902122`*^9, 3.735363929038431*^9}, {
   3.7353642000001264`*^9, 3.7353642253423853`*^9}, {3.7353657558960857`*^9, 
   3.73536575891171*^9}, {3.7353662639652634`*^9, 3.7353662929611673`*^9}, {
   3.7353699039426775`*^9, 3.7353699166042128`*^9}, {3.7353699765952444`*^9, 
   3.735369978704611*^9}, {3.7353700500990295`*^9, 3.735370059559373*^9}, {
   3.7353706530967855`*^9, 3.735370697438306*^9}, {3.735370743115124*^9, 
   3.7353707820411663`*^9}, {3.7353711099580517`*^9, 
   3.7353711514209027`*^9}, {3.7353717637228584`*^9, 
   3.7353717857178907`*^9}, {3.7353727103042307`*^9, 
   3.7353727109916983`*^9}, {3.735372862894586*^9, 3.735372863300972*^9}, {
   3.7353729018695116`*^9, 3.735373064065915*^9}, {3.735373105396386*^9, 
   3.735373117079811*^9}, {3.7353731542917604`*^9, 3.735373157807247*^9}, {
   3.735373200963481*^9, 3.7353732347684665`*^9}, {3.7353732730746574`*^9, 
   3.7353734049276876`*^9}, {3.7353737002015996`*^9, 3.735373705982852*^9}, {
   3.735373786058122*^9, 3.7353737867299967`*^9}, 3.7353738679109898`*^9, {
   3.7353739020204144`*^9, 3.7353739021768055`*^9}, {3.735373954819997*^9, 
   3.73537398309903*^9}, {3.7353741060858326`*^9, 3.7353742267456656`*^9}, {
   3.7353743132726974`*^9, 3.7353743723720207`*^9}, {3.7353745209105296`*^9, 
   3.7353745595592346`*^9}, {3.735374844942629*^9, 3.735374924738258*^9}, {
   3.735374961644905*^9, 3.735374977431453*^9}, {3.7353750254842815`*^9, 
   3.73537504170289*^9}, {3.735463137879011*^9, 3.7354631773946323`*^9}, {
   3.7354634045353374`*^9, 3.735463470269734*^9}, {3.735463566035408*^9, 
   3.735463569457288*^9}, 3.7354636394729147`*^9, {3.735463673801078*^9, 
   3.7354636804260707`*^9}, {3.7354637606136017`*^9, 3.735463764894852*^9}, {
   3.7354638525198703`*^9, 3.7354638625041447`*^9}, {3.7354643292747583`*^9, 
   3.7354643377121005`*^9}, {3.7354643691183634`*^9, 
   3.7354643861027436`*^9}, {3.735464452696651*^9, 3.735464496806055*^9}, 
   3.7354670476892505`*^9, 3.735535919727089*^9, {3.7360537171856585`*^9, 
   3.7360537320728645`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"b41ccc40-40d0-428f-9c5a-e02b4fa2873c"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"outerControls", "=", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Control", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"l", ",", "2", ",", "\"\<Subgraph size\>\""}], "}"}], 
             ",", "subgraphSizes"}], "}"}], "]"}], ",", "\"\<\>\"", ",", 
          RowBox[{"Control", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"generationTypes", ",", 
               RowBox[{"{", 
                RowBox[{"First", "[", 
                 RowBox[{"Keys", "[", "subgraphNodes", "]"}], "]"}], "}"}], 
               ",", "\"\<Generation type(s)\>\""}], "}"}], ",", 
             RowBox[{"Keys", "[", "subgraphNodes", "]"}], ",", 
             RowBox[{"ControlType", "\[Rule]", "TogglerBar"}], ",", 
             RowBox[{"Appearance", "\[Rule]", "\"\<Vertical\>\""}]}], "}"}], 
           "]"}], ",", 
          RowBox[{"Control", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"modelTypes", ",", 
               RowBox[{"{", 
                RowBox[{"First", "[", 
                 RowBox[{"Keys", "[", "subgraphNodes", "]"}], "]"}], "}"}], 
               ",", "\"\<Model type(s)\>\""}], "}"}], ",", 
             RowBox[{"Keys", "[", "subgraphNodes", "]"}], ",", 
             RowBox[{"ControlType", "\[Rule]", "TogglerBar"}], ",", 
             RowBox[{"Appearance", "\[Rule]", "\"\<Vertical\>\""}]}], "}"}], 
           "]"}]}], "}"}], "}"}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], "}"}], ",", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pMap", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "->", 
             RowBox[{"Symbol", "[", 
              RowBox[{"\"\<p\>\"", "<>", 
               RowBox[{"StringTake", "[", 
                RowBox[{"#", ",", "1"}], "]"}]}], "]"}]}], "&"}], ",", 
           RowBox[{"keySort", "[", "generationTypes", "]"}]}], "]"}]}], "}"}],
        ",", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"innerControls", "=", 
           RowBox[{"Grid", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<General\>\"", ",", 
                  RowBox[{"Control", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", "39"}], "}"}], ",", "2", ",", "1000", 
                    ",", "1", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], 
                    "}"}], "]"}], ",", 
                  RowBox[{"Control", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"t", ",", "100"}], "}"}], ",", "2", ",", "1000", 
                    ",", "1", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], 
                    "}"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<Single\>\"", ",", " ", 
                  RowBox[{"Button", "[", 
                   RowBox[{"\"\<Generate\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"counts", "=", 
                    RowBox[{"Values", "[", 
                    RowBox[{"countSubgraphs", "[", 
                    RowBox[{"l", ",", "n", ",", 
                    RowBox[{"generateGraphList", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"Association", "[", "pMap", "]"}]}], "]"}]}], 
                    "]"}], "]"}]}], "}"}]}], "]"}], ",", 
                  RowBox[{"Button", "[", 
                   RowBox[{"\"\<Analyse\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"singleAnalysis", "=", 
                    RowBox[{"estimateLikelihood", "[", 
                    RowBox[{"n", ",", "counts", ",", 
                    RowBox[{
                    RowBox[{"subgraphEquations", "[", "l", "]"}], "[", 
                    RowBox[{"keySort", "[", "modelTypes", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"subgraphLikelihoods", "[", "l", "]"}], "[", 
                    RowBox[{"keySort", "[", "modelTypes", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"subgraphPrecisions", "[", "l", "]"}], "[", 
                    RowBox[{"keySort", "[", "modelTypes", "]"}], "]"}]}], 
                    "]"}]}], "}"}]}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<Multiple\>\"", ",", 
                  RowBox[{"Button", "[", 
                   RowBox[{"\"\<Generate\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"countsList", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Values", "[", 
                    RowBox[{"countSubgraphs", "[", 
                    RowBox[{"l", ",", "n", ",", 
                    RowBox[{"generateGraphList", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"Association", "[", "pMap", "]"}]}], "]"}]}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "t"}], "}"}]}], "]"}]}], 
                    "}"}]}], "]"}], ",", 
                  RowBox[{"Button", "[", 
                   RowBox[{"\"\<Analyse\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"multipleAnalysis", "=", "\"\<TBI\>\""}], "}"}]}],
                    "]"}]}], "}"}]}], "}"}], ",", 
              RowBox[{"KeyValueMap", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#1", ",", 
                   RowBox[{"Control", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"#2", ",", "0.04"}], "}"}], ",", "0", ",", "0.1", 
                    ",", "0.01", ",", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], 
                    "}"}], "]"}], ",", "\"\<\>\""}], "}"}], "&"}], ",", 
                RowBox[{"Association", "[", "pMap", "]"}]}], "]"}]}], "]"}], 
            "]"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"counts", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"subgraphTypeLength", "[", "l", "]"}]}], "]"}]}], ";", 
          RowBox[{"countsList", "=", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"subgraphTypeLength", "[", "l", "]"}]}], "]"}], ",", 
             "2"}], "]"}]}], ";", 
          RowBox[{"singleAnalysis", "=", "\"\<Run Sim.\>\""}], ";", 
          RowBox[{"multipleAnalysis", "=", "\"\<Run Sim.\>\""}], ";", 
          RowBox[{"Manipulate", "[", 
           RowBox[{
            RowBox[{"subgraphGrid", "[", 
             RowBox[{
             "l", ",", "generationTypes", ",", "modelTypes", ",", "n", ",", 
              RowBox[{"Association", "[", "pMap", "]"}], ",", "t", ",", 
              "subgraphEquations", ",", "counts", ",", "countsList", ",", 
              "singleAnalysis", ",", "multipleAnalysis"}], "]"}], ",", 
            "innerControls"}], "]"}]}]}], "]"}]}], "]"}], ",", 
     "outerControls"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.735322888583871*^9, 3.735322888583871*^9}, {
   3.735323126301075*^9, 3.7353231518068266`*^9}, {3.735323219834231*^9, 
   3.7353232352143307`*^9}, {3.7353234422747583`*^9, 
   3.7353235924150906`*^9}, {3.7353564638909235`*^9, 3.735356508115877*^9}, {
   3.735356538362483*^9, 3.7353565610031266`*^9}, {3.7353566307686305`*^9, 
   3.7353566959405107`*^9}, {3.735356728018639*^9, 3.73535674626877*^9}, 
   3.7353637175991626`*^9, {3.735363780273616*^9, 3.7353638378942337`*^9}, {
   3.7353638704244156`*^9, 3.735363895868853*^9}, {3.7353639455079594`*^9, 
   3.7353639457579575`*^9}, {3.7353641789105463`*^9, 
   3.7353642278423843`*^9}, {3.7353655590266337`*^9, 3.735365620025198*^9}, {
   3.7353660184518967`*^9, 3.7353660753163013`*^9}, {3.7353662007864275`*^9, 
   3.735366261481042*^9}, {3.7353662959610357`*^9, 3.735366313957903*^9}, {
   3.735366356372202*^9, 3.7353663934271765`*^9}, {3.735366427488448*^9, 
   3.7353664719750957`*^9}, 3.7353668374817257`*^9, {3.73537166661331*^9, 
   3.7353717375593634`*^9}, {3.7353718648556185`*^9, 3.735371935730049*^9}, {
   3.7353719693106127`*^9, 3.735371973253292*^9}, {3.735372011144622*^9, 
   3.73537204345417*^9}, {3.7353721277083063`*^9, 3.7353722050238204`*^9}, {
   3.7353722669107733`*^9, 3.735372309715757*^9}, {3.7353724154083652`*^9, 
   3.7353724492831187`*^9}, {3.735372648723605*^9, 3.735372672989038*^9}, {
   3.735374436976554*^9, 3.7353744534298296`*^9}, {3.7353752762155848`*^9, 
   3.7353753120001764`*^9}, {3.735375371625534*^9, 3.735375379484766*^9}, {
   3.735375501582329*^9, 3.7353755545542345`*^9}, {3.735375852598383*^9, 
   3.735375857738867*^9}, {3.735375966457831*^9, 3.7353759922541666`*^9}, 
   3.7353760411203566`*^9, {3.73537615884943*^9, 3.735376170022069*^9}, {
   3.7354628113401732`*^9, 3.735463059855729*^9}, {3.73546310656652*^9, 
   3.735463109128995*^9}, {3.7354631828477793`*^9, 3.735463193035184*^9}, {
   3.7354632354882684`*^9, 3.7354633053790646`*^9}, {3.73546335917584*^9, 
   3.735463401613324*^9}, {3.7354635360822725`*^9, 3.7354635502228928`*^9}, {
   3.735463776410326*^9, 3.735463844785349*^9}, {3.7354640353710966`*^9, 
   3.7354640425898266`*^9}, {3.735464116480486*^9, 3.7354642026055093`*^9}, {
   3.7354644426652627`*^9, 3.735464511899809*^9}, {3.7354670277683463`*^9, 
   3.735467047111126*^9}, 3.7354670943372045`*^9, {3.735535794912949*^9, 
   3.73553580206466*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"e99d5a38-4268-4fca-a66c-ab47136c9287"],

Cell[TextData[{
 "Future work should extend the list of possible subgraphs, deal with the \
correlations within the census, develop an ",
 StyleBox["R",
  FontSlant->"Italic"],
 "-package and apply the model to real-world data."
}], "Text",
 CellChangeTimes->{{3.7313961183691397`*^9, 3.7313961250085583`*^9}, 
   3.736238005783177*^9, {3.7362418466115313`*^9, 
   3.7362418513493767`*^9}},ExpressionUUID->"be4af1aa-7901-4ff7-9e99-\
a1adbc9da5b7"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["References", "Section",
 CellChangeTimes->{{3.7361622603928947`*^9, 
  3.7361622728304005`*^9}},ExpressionUUID->"1dd09355-1f20-4db3-a5df-\
dbc825bdc30d"],

Cell["\<\
[1] C. R. Shalizi and A. Rinaldo, \"Consistency under sampling of exponential \
random graph models,\" The Annals of Statistics, vol. 41, pp. 508\[Dash]535, \
2013.
[2] S. Chatterjee and P. Diaconis, \"Estimating and understanding exponential \
random graph models,\" The Annals of Statistics, vol. 41, pp. \
2428\[Dash]2461, 2013.
[3] S. Bhamidi, G. Bresler, and A.Sly, \"Mixing time of exponential random \
graphs,\" The Annals of Applied Probability, vol. 21, pp. 2146\[Dash]2170, \
2011.
[4] A. G. Chandrasekhar and M. O. Jackson, \"Tractable and consistent random \
graph models,\" ArXiv, 2014. [Online]. Available: https \
://arxiv.org/abs/1210.7375.
[5] A. G. Chandrasekhar and M. O. Jackson, \"A network formation model based \
on subgraphs,\" ArXiv, 2016. [Online]. Available: \
https://arxiv.org/abs/1611.07658.
[6] A. G. Chandrasekhar, \"Econometrics of network formation,\" in The Oxford \
Handbook of the Economics of Networks, Y. Bramoulle, A. Galeotti, and B. \
Rogers, Eds. Oxford University Press, 2016.
[7] J. A. Davis and S. Leinhardt, \"The structure of positive interpersonal \
relations in small groups,\" in Sociological Theory in Progress, J. Berger, \
M. Zelditch, and B. Anderson, Eds. Houghton-Mifflin, 1972.
[8] P. W. Holland and S. Leinhardt, \"A method for detecting structure in \
sociometric data,\" American Journal of Sociology, vol. 76, pp. \
492\[Dash]513, 1970.
[9] P. W. Holland and S. Leinhardt, \"Local structure in social networks,\" \
Sociological Methodology, vol. 7, pp. 1\[Dash]45, 1976.\
\>", "Text",
 CellChangeTimes->{{3.7361622667991495`*^9, 3.736162278596022*^9}, {
   3.7361623089866533`*^9, 3.736162460860938*^9}, {3.736237670936941*^9, 
   3.736237734291402*^9}, 
   3.736237782605814*^9},ExpressionUUID->"8c9ba590-619d-49cd-a50d-\
978878485bfa"]
}, Closed]]
}, Open  ]]
},
WindowSize->{1920, 1007},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 237, 4, 96, "Title",ExpressionUUID->"8f6ba89d-3c28-4ee5-949d-393fa35e6fce"],
Cell[820, 28, 336, 6, 51, "Subsubtitle",ExpressionUUID->"c185089a-75bc-47b7-98eb-f4ae90efd4d9"],
Cell[CellGroupData[{
Cell[1181, 38, 214, 4, 67, "Section",ExpressionUUID->"7128cf08-7110-4f96-975b-dad6a102c09f"],
Cell[1398, 44, 1407, 24, 210, "Text",ExpressionUUID->"2b412d49-4302-46f2-a481-f763a12c88af"],
Cell[2808, 70, 475, 8, 28, "Input",ExpressionUUID->"f5be415c-7994-41ae-99ef-bad344b357cd"]
}, Closed]],
Cell[CellGroupData[{
Cell[3320, 83, 259, 4, 53, "Section",ExpressionUUID->"ffb55aa8-dbfc-4cdf-952b-e33f8d6c0061"],
Cell[3582, 89, 1398, 41, 56, "Text",ExpressionUUID->"41a58947-fa06-4943-acc6-fc06a6fe9048"],
Cell[CellGroupData[{
Cell[5005, 134, 241, 4, 53, "Subsection",ExpressionUUID->"0aa8c034-c27e-40fd-865c-dfb3ba6bc78c"],
Cell[5249, 140, 150, 3, 34, "Text",ExpressionUUID->"855f78c9-86ee-4a90-bafd-df92fbaf9656"],
Cell[5402, 145, 286, 6, 28, "Input",ExpressionUUID->"6eeed15d-e16a-4848-a2cb-6e06a1616b73"],
Cell[5691, 153, 843, 15, 28, "Input",ExpressionUUID->"8a6c9d73-8bb4-4607-9842-1db1d6d1ef05"],
Cell[6537, 170, 2936, 77, 48, "Input",ExpressionUUID->"9a53b5c3-3713-4cc3-b7b2-d51aefde4cae"],
Cell[9476, 249, 5248, 142, 86, "Input",ExpressionUUID->"61f09b4b-a51a-443d-b490-eb656f7432ea"]
}, Closed]],
Cell[CellGroupData[{
Cell[14761, 396, 271, 4, 53, "Subsection",ExpressionUUID->"d1677566-2ef4-4d9a-bda6-34cb1b4aea21"],
Cell[15035, 402, 318, 7, 34, "Text",ExpressionUUID->"6b13224d-76cf-4ba2-917f-cf50a5fbf396"],
Cell[15356, 411, 1504, 35, 28, "Input",ExpressionUUID->"e12821af-4f69-4eda-b19e-f6fb6ccb1489"],
Cell[16863, 448, 881, 18, 28, "Input",ExpressionUUID->"c2316eec-5e18-4751-8f83-d2b8ee8ac5c4"],
Cell[17747, 468, 627, 15, 28, "Input",ExpressionUUID->"1e8b3f1e-91d5-4712-99d1-82e4156f30a6"],
Cell[18377, 485, 7567, 160, 124, "Input",ExpressionUUID->"6a126404-58a0-400a-871f-d8733be06ce3"],
Cell[25947, 647, 433, 10, 34, "Text",ExpressionUUID->"1bd9db9e-0160-4573-810f-4428c39e5f3f"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[26429, 663, 219, 4, 53, "Section",ExpressionUUID->"9cb124b7-49d8-4205-b351-1fe9fc0ded06"],
Cell[26651, 669, 493, 9, 34, "Text",ExpressionUUID->"f3df441d-7594-489d-b678-4e4614b60342"],
Cell[CellGroupData[{
Cell[27169, 682, 281, 4, 53, "Subsection",ExpressionUUID->"5570249b-c4a1-496b-a9f0-f70fd1f3d08e"],
Cell[27453, 688, 150, 3, 34, "Text",ExpressionUUID->"94796fc5-7ef6-4608-ab1a-fd52dcabf67c"],
Cell[27606, 693, 2985, 72, 67, "Input",ExpressionUUID->"09d73d03-3e58-4474-93f6-76001c0482b7"],
Cell[30594, 767, 6986, 161, 124, "Input",ExpressionUUID->"e1a573d7-6a95-4653-9b36-27dce1c3e278"],
Cell[37583, 930, 150, 3, 34, "Text",ExpressionUUID->"3a540760-2a0f-4f9e-b876-3a34a1b2b3ba"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[37782, 939, 273, 4, 53, "Section",ExpressionUUID->"6b64f766-2d6f-4b53-b40b-fa2c6dfc2ff6"],
Cell[38058, 945, 150, 3, 34, "Text",ExpressionUUID->"eb9a74f9-b6ef-429d-ae83-92fb89967539"],
Cell[CellGroupData[{
Cell[38233, 952, 240, 4, 53, "Subsection",ExpressionUUID->"6fa987bc-30f7-47da-9025-5c67c6e34962"],
Cell[38476, 958, 150, 3, 34, "Text",ExpressionUUID->"1572f5a2-6dc0-4d52-a2b8-6c3ac30dff2a"],
Cell[38629, 963, 1945, 47, 48, "Input",ExpressionUUID->"fffb1614-bf7c-4e98-be99-4371790c202e"],
Cell[40577, 1012, 2237, 57, 105, "Input",ExpressionUUID->"6bfcdedc-e37f-4f12-8988-19454ce033fb"],
Cell[42817, 1071, 150, 3, 34, "Text",ExpressionUUID->"dff6eaf6-c740-420a-b9ae-d33e913e8aeb"]
}, Closed]],
Cell[CellGroupData[{
Cell[43004, 1079, 239, 4, 53, "Subsection",ExpressionUUID->"0adcd58b-aab2-490a-a6ac-6cb68724e650"],
Cell[43246, 1085, 150, 3, 34, "Text",ExpressionUUID->"473a5bee-2143-4645-9e02-8d00131556fa"],
Cell[43399, 1090, 2312, 58, 67, "Input",ExpressionUUID->"ef3c24bf-4cad-486c-9b3c-c2892df9ade1"],
Cell[45714, 1150, 3570, 82, 86, "Input",ExpressionUUID->"90865b3e-5949-4057-9f9a-35901ebd95e5"],
Cell[49287, 1234, 2229, 59, 67, "Input",ExpressionUUID->"d6ebdd83-b966-4d44-a03b-58adfbe1bf19"],
Cell[51519, 1295, 2950, 75, 67, "Input",ExpressionUUID->"a990f015-7534-4d07-b31a-df2287d8ccd4"],
Cell[54472, 1372, 2259, 54, 67, "Input",ExpressionUUID->"310d5584-fa8b-480c-ba73-0ab686b1a24b"],
Cell[56734, 1428, 2817, 76, 86, "Input",ExpressionUUID->"a47af384-b280-4cea-bd2d-ddac1f4051ed"],
Cell[59554, 1506, 150, 3, 34, "Text",ExpressionUUID->"c8fdecc0-b41c-449a-ba48-9655e93b1688"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[59753, 1515, 273, 4, 53, "Section",ExpressionUUID->"a67244df-8005-4608-a14c-56ecb05cccd7"],
Cell[60029, 1521, 749, 18, 56, "Text",ExpressionUUID->"386481d8-6253-42aa-ac36-1781ccafba7b"],
Cell[CellGroupData[{
Cell[60803, 1543, 246, 4, 53, "Subsection",ExpressionUUID->"a0a1012f-96e9-417d-878e-a6ade2b6d680"],
Cell[61052, 1549, 150, 3, 34, "Text",ExpressionUUID->"2cf3dd60-df5e-4e4a-a1cd-e27f4562c9a8"],
Cell[61205, 1554, 679, 16, 28, "Input",ExpressionUUID->"7b16d529-e568-43b3-ac6d-dd0cdc0ad237"],
Cell[61887, 1572, 12530, 255, 200, "Input",ExpressionUUID->"2d59eb91-547d-4882-b398-da8a140972ce"],
Cell[74420, 1829, 815, 14, 105, "Input",ExpressionUUID->"78c1f7a0-591a-4546-8c53-02049b84d8c3"],
Cell[75238, 1845, 12290, 324, 257, "Input",ExpressionUUID->"eb9b9ac0-9058-4c91-9061-6d9303eaa1b8"],
Cell[87531, 2171, 749, 20, 28, "Input",ExpressionUUID->"5c7531cb-7d0a-4d52-9639-738b8e5811b4"],
Cell[88283, 2193, 2978, 74, 67, "Input",ExpressionUUID->"5020d4d8-f762-41d3-80f9-a413285ec3b5"],
Cell[91264, 2269, 609, 13, 28, "Input",ExpressionUUID->"79409510-5555-41a8-a42b-5487d631d517"],
Cell[91876, 2284, 4036, 89, 124, "Input",ExpressionUUID->"caaf14cd-fc0c-48cf-b2e5-18646fd8c426"],
Cell[95915, 2375, 3778, 86, 86, "Input",ExpressionUUID->"f47e83b6-6a28-4fc5-86c4-5122a025481f"],
Cell[99696, 2463, 7994, 163, 124, "Input",ExpressionUUID->"95565ad1-9ffa-4fb7-8714-63a9f427d30a"],
Cell[107693, 2628, 4778, 97, 86, "Input",ExpressionUUID->"adeca30f-f28f-40de-85fe-2fbb1901961f"],
Cell[112474, 2727, 739, 20, 28, "Input",ExpressionUUID->"1e61f050-4ff7-4775-9a92-f4c97c814bfc"],
Cell[113216, 2749, 3889, 90, 86, "Input",ExpressionUUID->"4aeb1401-5e32-48c7-bacb-45d2ec78dbb8"],
Cell[117108, 2841, 3579, 85, 124, "Input",ExpressionUUID->"f58c7147-c401-4f20-9710-c90eef4a5973"],
Cell[120690, 2928, 3978, 88, 124, "Input",ExpressionUUID->"ec9ae38a-9847-47dd-9916-b2dbae746fad"],
Cell[124671, 3018, 2075, 50, 86, "Input",ExpressionUUID->"d32e9cd1-d009-44bd-a964-f046c4a20a63"],
Cell[126749, 3070, 150, 3, 34, "Text",ExpressionUUID->"41504ec6-94a7-4288-b675-676cb91286fa"]
}, Closed]],
Cell[CellGroupData[{
Cell[126936, 3078, 247, 4, 53, "Subsection",ExpressionUUID->"26eec612-f744-4cde-86ff-36987006f50f"],
Cell[127186, 3084, 1506, 39, 58, "Text",ExpressionUUID->"75d9e694-79d0-4d87-90ed-4bdd80a32aa2"],
Cell[128695, 3125, 912, 16, 28, "Input",ExpressionUUID->"0a7d89ec-f1df-432f-97a2-8575ef91e55a"],
Cell[129610, 3143, 606, 10, 28, "Input",ExpressionUUID->"84b8c709-f3bb-4db4-ae91-4a77e64d1f07"],
Cell[130219, 3155, 326, 7, 28, "Input",ExpressionUUID->"ee2c8855-72d7-4a64-a0b7-627de7014fd2"],
Cell[130548, 3164, 324, 7, 28, "Input",ExpressionUUID->"3b6bbdbe-5fae-4734-93cd-60d1191d0637"],
Cell[130875, 3173, 7138, 150, 143, "Input",ExpressionUUID->"b41ccc40-40d0-428f-9c5a-e02b4fa2873c"],
Cell[138016, 3325, 10321, 212, 295, "Input",ExpressionUUID->"e99d5a38-4268-4fca-a66c-ab47136c9287"],
Cell[148340, 3539, 447, 10, 34, "Text",ExpressionUUID->"be4af1aa-7901-4ff7-9e99-a1adbc9da5b7"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[148836, 3555, 159, 3, 53, "Section",ExpressionUUID->"1dd09355-1f20-4db3-a5df-dbc825bdc30d"],
Cell[148998, 3560, 1809, 32, 210, "Text",ExpressionUUID->"8c9ba590-619d-49cd-a50d-978878485bfa"]
}, Closed]]
}, Open  ]]
}
]
*)

